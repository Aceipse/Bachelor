A stream that emits multiple other streams one after another.

\subsection*{Installation}


\begin{DoxyCode}
1 npm install combined-stream
\end{DoxyCode}


\subsection*{Usage}

Here is a simple example that shows how you can use combined-\/stream to combine two files into one\+:


\begin{DoxyCode}
1 var CombinedStream = require('combined-stream');
2 var fs = require('fs');
3 
4 var combinedStream = CombinedStream.create();
5 combinedStream.append(fs.createReadStream('file1.txt'));
6 combinedStream.append(fs.createReadStream('file2.txt'));
7 
8 combinedStream.pipe(fs.createWriteStream('combined.txt'));
\end{DoxyCode}


While the example above works great, it will pause all source streams until they are needed. If you don\textquotesingle{}t want that to happen, you can set {\ttfamily pause\+Streams} to {\ttfamily false}\+:


\begin{DoxyCode}
1 var CombinedStream = require('combined-stream');
2 var fs = require('fs');
3 
4 var combinedStream = CombinedStream.create(\{pauseStreams: false\});
5 combinedStream.append(fs.createReadStream('file1.txt'));
6 combinedStream.append(fs.createReadStream('file2.txt'));
7 
8 combinedStream.pipe(fs.createWriteStream('combined.txt'));
\end{DoxyCode}


However, what if you don\textquotesingle{}t have all the source streams yet, or you don\textquotesingle{}t want to allocate the resources (file descriptors, memory, etc.) for them right away? Well, in that case you can simply provide a callback that supplies the stream by calling a {\ttfamily next()} function\+:


\begin{DoxyCode}
1 var CombinedStream = require('combined-stream');
2 var fs = require('fs');
3 
4 var combinedStream = CombinedStream.create();
5 combinedStream.append(function(next) \{
6   next(fs.createReadStream('file1.txt'));
7 \});
8 combinedStream.append(function(next) \{
9   next(fs.createReadStream('file2.txt'));
10 \});
11 
12 combinedStream.pipe(fs.createWriteStream('combined.txt'));
\end{DoxyCode}


\subsection*{A\+P\+I}

\subsubsection*{Combined\+Stream.\+create(\mbox{[}options\mbox{]})}

Returns a new combined stream object. Available options are\+:


\begin{DoxyItemize}
\item {\ttfamily max\+Data\+Size}
\item {\ttfamily pause\+Streams}
\end{DoxyItemize}

The effect of those options is described below.

\subsubsection*{combined\+Stream.\+pause\+Streams = {\ttfamily true}}

Whether to apply back pressure to the underlaying streams. If set to {\ttfamily false}, the underlaying streams will never be paused. If set to {\ttfamily true}, the underlaying streams will be paused right after being appended, as well as when {\ttfamily delayed\+Stream.\+pipe()} wants to throttle.

\subsubsection*{combined\+Stream.\+max\+Data\+Size = {\ttfamily 2 $\ast$ 1024 $\ast$ 1024}}

The maximum amount of bytes (or characters) to buffer for all source streams. If this value is exceeded, {\ttfamily combined\+Stream} emits an {\ttfamily \textquotesingle{}error\textquotesingle{}} event.

\subsubsection*{combined\+Stream.\+data\+Size = {\ttfamily 0}}

The amount of bytes (or characters) currently buffered by {\ttfamily combined\+Stream}.

\subsubsection*{combined\+Stream.\+append(stream)}

Appends the given {\ttfamily stream} to the combined\+Stream object. If {\ttfamily pause\+Streams} is set to `true, this stream will also be paused right away.

{\ttfamily streams} can also be a function that takes one parameter called {\ttfamily next}. {\ttfamily next} is a function that must be invoked in order to provide the {\ttfamily next} stream, see example above.

Regardless of how the {\ttfamily stream} is appended, combined-\/stream always attaches an {\ttfamily \textquotesingle{}error\textquotesingle{}} listener to it, so you don\textquotesingle{}t have to do that manually.

Special case\+: {\ttfamily stream} can also be a String or Buffer.

\subsubsection*{combined\+Stream.\+write(data)}

You should not call this, {\ttfamily combined\+Stream} takes care of piping the appended streams into itself for you.

\subsubsection*{combined\+Stream.\+resume()}

Causes {\ttfamily combined\+Stream} to start drain the streams it manages. The function is idempotent, and also emits a {\ttfamily \textquotesingle{}resume\textquotesingle{}} event each time which usually goes to the stream that is currently being drained.

\subsubsection*{combined\+Stream.\+pause();}

If {\ttfamily combined\+Stream.\+pause\+Streams} is set to {\ttfamily false}, this does nothing. Otherwise a {\ttfamily \textquotesingle{}pause\textquotesingle{}} event is emitted, this goes to the stream that is currently being drained, so you can use it to apply back pressure.

\subsubsection*{combined\+Stream.\+end();}

Sets {\ttfamily combined\+Stream.\+writable} to false, emits an {\ttfamily \textquotesingle{}end\textquotesingle{}} event, and removes all streams from the queue.

\subsubsection*{combined\+Stream.\+destroy();}

Same as {\ttfamily combined\+Stream.\+end()}, except it emits a {\ttfamily \textquotesingle{}close\textquotesingle{}} event instead of {\ttfamily \textquotesingle{}end\textquotesingle{}}.

\subsection*{License}

combined-\/stream is licensed under the M\+I\+T license. 