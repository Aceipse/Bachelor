
\begin{DoxyCode}
1 var fs   = require('fs')
2 var zlib = require('zlib')
3 var strs = require('stringstream')
4 
5 var utf8Stream = fs.createReadStream('massiveLogFile.gz')
6   .pipe(zlib.createGunzip())
7   .pipe(strs('utf8'))
\end{DoxyCode}


No need to deal with {\ttfamily set\+Encoding()} weirdness, just compose streams like they were supposed to be!

Handles input and output encoding\+:


\begin{DoxyCode}
1 // Stream from utf8 to hex to base64... Why not, ay.
2 var hex64Stream = fs.createReadStream('myFile')
3   .pipe(strs('utf8', 'hex'))
4   .pipe(strs('hex', 'base64'))
\end{DoxyCode}


Also deals with {\ttfamily base64} output correctly by aligning each emitted data chunk so that there are no dangling {\ttfamily =} characters\+:


\begin{DoxyCode}
1 var stream = fs.createReadStream('myFile').pipe(strs('base64'))
2 
3 var base64Str = ''
4 
5 stream.on('data', function(data) \{ base64Str += data \})
6 stream.on('end', function() \{
7   console.log('My base64 encoded file is: ' + base64Str) // Wouldn't work with setEncoding()
8   console.log('Original file is: ' + new Buffer(base64Str, 'base64'))
9 \})
\end{DoxyCode}
 