An S\+N\+T\+P v4 client (R\+F\+C4330) for node. Simpy connects to the N\+T\+P or S\+N\+T\+P server requested and returns the server time along with the roundtrip duration and clock offset. To adjust the local time to the N\+T\+P time, add the returned {\ttfamily t} offset to the local time.

\href{http://travis-ci.org/hueniverse/sntp}{\tt !\mbox{[}Build Status\mbox{]}(https\+://secure.\+travis-\/ci.\+org/hueniverse/sntp.\+png)}

\section*{Usage}


\begin{DoxyCode}
1 var Sntp = require('sntp');
2 
3 // All options are optional
4 
5 var options = \{
6     host: 'nist1-sj.ustiming.org',  // Defaults to pool.ntp.org
7     port: 123,                      // Defaults to 123 (NTP)
8     resolveReference: true,         // Default to false (not resolving)
9     timeout: 1000                   // Defaults to zero (no timeout)
10 \};
11 
12 // Request server time
13 
14 Sntp.time(options, function (err, time) \{
15 
16     if (err) \{
17         console.log('Failed: ' + err.message);
18         process.exit(1);
19     \}
20 
21     console.log('Local clock is off by: ' + time.t + ' milliseconds');
22     process.exit(0);
23 \});
\end{DoxyCode}


If an application needs to maintain continuous time synchronization, the module provides a stateful method for querying the current offset only when the last one is too old (defaults to daily).


\begin{DoxyCode}
1 // Request offset once
2 
3 Sntp.offset(function (err, offset) \{
4 
5     console.log(offset);                    // New (served fresh)
6 
7     // Request offset again
8 
9     Sntp.offset(function (err, offset) \{
10 
11         console.log(offset);                // Identical (served from cache)
12     \});
13 \});
\end{DoxyCode}


To set a background offset refresh, start the interval and use the provided now() method. If for any reason the client fails to obtain an up-\/to-\/date offset, the current system clock is used.


\begin{DoxyCode}
1 var before = Sntp.now();                    // System time without offset
2 
3 Sntp.start(function () \{
4 
5     var now = Sntp.now();                   // With offset
6     Sntp.stop();
7 \});
\end{DoxyCode}
 