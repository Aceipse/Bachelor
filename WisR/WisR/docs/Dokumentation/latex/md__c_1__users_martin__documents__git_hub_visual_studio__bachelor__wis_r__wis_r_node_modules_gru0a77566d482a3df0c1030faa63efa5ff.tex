A module to create readable {\ttfamily \char`\"{}multipart/form-\/data\char`\"{}} streams. Can be used to submit forms and file uploads to other web applications.

The A\+P\+I of this module is inspired by the \href{http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface}{\tt X\+M\+L\+Http\+Request-\/2 Form\+Data Interface}.

\subsection*{Install}


\begin{DoxyCode}
1 npm install form-data
\end{DoxyCode}


\subsection*{Usage}

In this example we are constructing a form with 3 fields that contain a string, a buffer and a file stream.


\begin{DoxyCode}
1 var FormData = require('form-data');
2 var fs = require('fs');
3 
4 var form = new FormData();
5 form.append('my\_field', 'my value');
6 form.append('my\_buffer', new Buffer(10));
7 form.append('my\_file', fs.createReadStream('/foo/bar.jpg'));
\end{DoxyCode}


Also you can use http-\/response stream\+:


\begin{DoxyCode}
1 var FormData = require('form-data');
2 var http = require('http');
3 
4 var form = new FormData();
5 
6 http.request('http://nodejs.org/images/logo.png', function(response) \{
7   form.append('my\_field', 'my value');
8   form.append('my\_buffer', new Buffer(10));
9   form.append('my\_logo', response);
10 \});
\end{DoxyCode}


Or \textquotesingle{}s request stream\+:


\begin{DoxyCode}
1 var FormData = require('form-data');
2 var request = require('request');
3 
4 var form = new FormData();
5 
6 form.append('my\_field', 'my value');
7 form.append('my\_buffer', new Buffer(10));
8 form.append('my\_logo', request('http://nodejs.org/images/logo.png'));
\end{DoxyCode}


In order to submit this form to a web application, call {\ttfamily submit(url, \mbox{[}callback\mbox{]})} method\+:


\begin{DoxyCode}
1 form.submit('http://example.org/', function(err, res) \{
2   // res â€“ response object (http.IncomingMessage)  //
3   res.resume(); // for node-0.10.x
4 \});
\end{DoxyCode}


For more advanced request manipulations {\ttfamily submit()} method returns {\ttfamily http.\+Client\+Request} object, or you can choose from one of the alternative submission methods.

\subsubsection*{Alternative submission methods}

You can use node\textquotesingle{}s http client interface\+:


\begin{DoxyCode}
1 var http = require('http');
2 
3 var request = http.request(\{
4   method: 'post',
5   host: 'example.org',
6   path: '/upload',
7   headers: form.getHeaders()
8 \});
9 
10 form.pipe(request);
11 
12 request.on('response', function(res) \{
13   console.log(res.statusCode);
14 \});
\end{DoxyCode}


Or if you would prefer the {\ttfamily \textquotesingle{}Content-\/\+Length\textquotesingle{}} header to be set for you\+:


\begin{DoxyCode}
1 form.submit('example.org/upload', function(err, res) \{
2   console.log(res.statusCode);
3 \});
\end{DoxyCode}


To use custom headers and pre-\/known length in parts\+:


\begin{DoxyCode}
1 var CRLF = '\(\backslash\)r\(\backslash\)n';
2 var form = new FormData();
3 
4 var options = \{
5   header: CRLF + '--' + form.getBoundary() + CRLF + 'X-Custom-Header: 123' + CRLF + CRLF,
6   knownLength: 1
7 \};
8 
9 form.append('my\_buffer', buffer, options);
10 
11 form.submit('http://example.com/', function(err, res) \{
12   if (err) throw err;
13   console.log('Done');
14 \});
\end{DoxyCode}


Form-\/\+Data can recognize and fetch all the required information from common types of streams ({\ttfamily fs.\+read\+Stream}, {\ttfamily http.\+response} and {\ttfamily mikeal\textquotesingle{}s request}), for some other types of streams you\textquotesingle{}d need to provide \char`\"{}file\char`\"{}-\/related information manually\+:


\begin{DoxyCode}
1 someModule.stream(function(err, stdout, stderr) \{
2   if (err) throw err;
3 
4   var form = new FormData();
5 
6   form.append('file', stdout, \{
7     filename: 'unicycle.jpg',
8     contentType: 'image/jpg',
9     knownLength: 19806
10   \});
11 
12   form.submit('http://example.com/', function(err, res) \{
13     if (err) throw err;
14     console.log('Done');
15   \});
16 \});
\end{DoxyCode}


For edge cases, like P\+O\+S\+T request to U\+R\+L with query string or to pass H\+T\+T\+P auth credentials, object can be passed to {\ttfamily form.\+submit()} as first parameter\+:


\begin{DoxyCode}
1 form.submit(\{
2   host: 'example.com',
3   path: '/probably.php?extra=params',
4   auth: 'username:password'
5 \}, function(err, res) \{
6   console.log(res.statusCode);
7 \});
\end{DoxyCode}


In case you need to also send custom H\+T\+T\+P headers with the P\+O\+S\+T request, you can use the {\ttfamily headers} key in first parameter of {\ttfamily form.\+submit()}\+:


\begin{DoxyCode}
1 form.submit(\{
2   host: 'example.com',
3   path: '/surelynot.php',
4   headers: \{'x-test-header': 'test-header-value'\}
5 \}, function(err, res) \{
6   console.log(res.statusCode);
7 \});
\end{DoxyCode}


\subsection*{Notes}


\begin{DoxyItemize}
\item {\ttfamily get\+Length\+Sync()} method D\+O\+E\+S\+N\textquotesingle{}T calculate length for streams, use {\ttfamily known\+Length} options as workaround.
\item If it feels like Form\+Data hangs after submit and you\textquotesingle{}re on {\ttfamily node-\/0.\+10}, please check \href{http://nodejs.org/api/stream.html#stream_compatibility_with_older_node_versions}{\tt Compatibility with Older Node Versions}
\end{DoxyItemize}

\subsection*{T\+O\+D\+O}


\begin{DoxyItemize}
\item Add new streams (0.\+10) support and try really hard not to break it for 0.\+8.\+x.
\end{DoxyItemize}

\subsection*{License}

Form-\/\+Data is licensed under the M\+I\+T license. 