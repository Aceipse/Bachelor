<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WisR web applikation: C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/CryptoJS/components/sha3.js</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WisR web applikation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/CryptoJS/components/sha3.js</div>  </div>
</div><!--header-->
<div class="contents">
<p>Shortcut function to the hasher's object interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">{WordArray|string}</td><td>message The message to hash.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{WordArray} The hash.</dd></dl>
<pre class="fragment">var hash = CryptoJS.SHA3('message');
var hash = CryptoJS.SHA3(wordArray);</pre><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">CryptoJS v3.1.2</span></div>
<div class="line"><span class="comment">code.google.com/p/crypto-js</span></div>
<div class="line"><span class="comment">(c) 2009-2013 by Jeff Mott. All rights reserved.</span></div>
<div class="line"><span class="comment">code.google.com/p/crypto-js/wiki/License</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line">(<span class="keyword">function</span> (Math) {</div>
<div class="line">    <span class="comment">// Shortcuts</span></div>
<div class="line">    var C = CryptoJS;</div>
<div class="line">    var C_lib = C.lib;</div>
<div class="line">    var WordArray = C_lib.WordArray;</div>
<div class="line">    var Hasher = C_lib.Hasher;</div>
<div class="line">    var C_x64 = C.x64;</div>
<div class="line">    var X64Word = C_x64.Word;</div>
<div class="line">    var C_algo = C.algo;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Constants tables</span></div>
<div class="line">    var RHO_OFFSETS = [];</div>
<div class="line">    var PI_INDEXES  = [];</div>
<div class="line">    var ROUND_CONSTANTS = [];</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Compute Constants</span></div>
<div class="line">    (<span class="keyword">function</span> () {</div>
<div class="line">        <span class="comment">// Compute rho offset constants</span></div>
<div class="line">        var x = 1, y = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (var t = 0; t &lt; 24; t++) {</div>
<div class="line">            RHO_OFFSETS[x + 5 * y] = ((t + 1) * (t + 2) / 2) % 64;</div>
<div class="line"></div>
<div class="line">            var newX = y % 5;</div>
<div class="line">            var newY = (2 * x + 3 * y) % 5;</div>
<div class="line">            x = newX;</div>
<div class="line">            y = newY;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Compute pi index constants</span></div>
<div class="line">        <span class="keywordflow">for</span> (var x = 0; x &lt; 5; x++) {</div>
<div class="line">            <span class="keywordflow">for</span> (var y = 0; y &lt; 5; y++) {</div>
<div class="line">                PI_INDEXES[x + 5 * y] = y + ((2 * x + 3 * y) % 5) * 5;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Compute round constants</span></div>
<div class="line">        var LFSR = 0x01;</div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; 24; i++) {</div>
<div class="line">            var roundConstantMsw = 0;</div>
<div class="line">            var roundConstantLsw = 0;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">for</span> (var j = 0; j &lt; 7; j++) {</div>
<div class="line">                <span class="keywordflow">if</span> (LFSR &amp; 0x01) {</div>
<div class="line">                    var bitPosition = (1 &lt;&lt; j) - 1;</div>
<div class="line">                    <span class="keywordflow">if</span> (bitPosition &lt; 32) {</div>
<div class="line">                        roundConstantLsw ^= 1 &lt;&lt; bitPosition;</div>
<div class="line">                    } <span class="keywordflow">else</span> <span class="comment">/* if (bitPosition &gt;= 32) */</span> {</div>
<div class="line">                        roundConstantMsw ^= 1 &lt;&lt; (bitPosition - 32);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Compute next LFSR</span></div>
<div class="line">                <span class="keywordflow">if</span> (LFSR &amp; 0x80) {</div>
<div class="line">                    <span class="comment">// Primitive polynomial over GF(2): x^8 + x^6 + x^5 + x^4 + 1</span></div>
<div class="line">                    LFSR = (LFSR &lt;&lt; 1) ^ 0x71;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    LFSR &lt;&lt;= 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            ROUND_CONSTANTS[i] = X64Word.create(roundConstantMsw, roundConstantLsw);</div>
<div class="line">        }</div>
<div class="line">    }());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Reusable objects for temporary values</span></div>
<div class="line">    var T = [];</div>
<div class="line">    (<span class="keyword">function</span> () {</div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; 25; i++) {</div>
<div class="line">            T[i] = X64Word.create();</div>
<div class="line">        }</div>
<div class="line">    }());</div>
<div class="line"></div>
<div class="line">    var SHA3 = C_algo.SHA3 = Hasher.extend({</div>
<div class="line">        cfg: Hasher.cfg.extend({</div>
<div class="line">            outputLength: 512</div>
<div class="line">        }),</div>
<div class="line"></div>
<div class="line">        _doReset: <span class="keyword">function</span> () {</div>
<div class="line">            var state = this._state = []</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 25; i++) {</div>
<div class="line">                state[i] = <span class="keyword">new</span> X64Word.init();</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            this.blockSize = (1600 - 2 * this.cfg.outputLength) / 32;</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        _doProcessBlock: <span class="keyword">function</span> (M, offset) {</div>
<div class="line">            <span class="comment">// Shortcuts</span></div>
<div class="line">            var state = this._state;</div>
<div class="line">            var nBlockSizeLanes = this.blockSize / 2;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Absorb</span></div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; nBlockSizeLanes; i++) {</div>
<div class="line">                <span class="comment">// Shortcuts</span></div>
<div class="line">                var M2i  = M[offset + 2 * i];</div>
<div class="line">                var M2i1 = M[offset + 2 * i + 1];</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Swap endian</span></div>
<div class="line">                M2i = (</div>
<div class="line">                    (((M2i &lt;&lt; 8)  | (M2i &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                    (((M2i &lt;&lt; 24) | (M2i &gt;&gt;&gt; 8))  &amp; 0xff00ff00)</div>
<div class="line">                );</div>
<div class="line">                M2i1 = (</div>
<div class="line">                    (((M2i1 &lt;&lt; 8)  | (M2i1 &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                    (((M2i1 &lt;&lt; 24) | (M2i1 &gt;&gt;&gt; 8))  &amp; 0xff00ff00)</div>
<div class="line">                );</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Absorb message into state</span></div>
<div class="line">                var lane = state[i];</div>
<div class="line">                lane.high ^= M2i1;</div>
<div class="line">                lane.low  ^= M2i;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Rounds</span></div>
<div class="line">            <span class="keywordflow">for</span> (var round = 0; round &lt; 24; round++) {</div>
<div class="line">                <span class="comment">// Theta</span></div>
<div class="line">                <span class="keywordflow">for</span> (var x = 0; x &lt; 5; x++) {</div>
<div class="line">                    <span class="comment">// Mix column lanes</span></div>
<div class="line">                    var tMsw = 0, tLsw = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (var y = 0; y &lt; 5; y++) {</div>
<div class="line">                        var lane = state[x + 5 * y];</div>
<div class="line">                        tMsw ^= lane.high;</div>
<div class="line">                        tLsw ^= lane.low;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Temporary values</span></div>
<div class="line">                    var Tx = T[x];</div>
<div class="line">                    Tx.high = tMsw;</div>
<div class="line">                    Tx.low  = tLsw;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">for</span> (var x = 0; x &lt; 5; x++) {</div>
<div class="line">                    <span class="comment">// Shortcuts</span></div>
<div class="line">                    var Tx4 = T[(x + 4) % 5];</div>
<div class="line">                    var Tx1 = T[(x + 1) % 5];</div>
<div class="line">                    var Tx1Msw = Tx1.high;</div>
<div class="line">                    var Tx1Lsw = Tx1.low;</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Mix surrounding columns</span></div>
<div class="line">                    var tMsw = Tx4.high ^ ((Tx1Msw &lt;&lt; 1) | (Tx1Lsw &gt;&gt;&gt; 31));</div>
<div class="line">                    var tLsw = Tx4.low  ^ ((Tx1Lsw &lt;&lt; 1) | (Tx1Msw &gt;&gt;&gt; 31));</div>
<div class="line">                    <span class="keywordflow">for</span> (var y = 0; y &lt; 5; y++) {</div>
<div class="line">                        var lane = state[x + 5 * y];</div>
<div class="line">                        lane.high ^= tMsw;</div>
<div class="line">                        lane.low  ^= tLsw;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Rho Pi</span></div>
<div class="line">                <span class="keywordflow">for</span> (var laneIndex = 1; laneIndex &lt; 25; laneIndex++) {</div>
<div class="line">                    <span class="comment">// Shortcuts</span></div>
<div class="line">                    var lane = state[laneIndex];</div>
<div class="line">                    var laneMsw = lane.high;</div>
<div class="line">                    var laneLsw = lane.low;</div>
<div class="line">                    var rhoOffset = RHO_OFFSETS[laneIndex];</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Rotate lanes</span></div>
<div class="line">                    <span class="keywordflow">if</span> (rhoOffset &lt; 32) {</div>
<div class="line">                        var tMsw = (laneMsw &lt;&lt; rhoOffset) | (laneLsw &gt;&gt;&gt; (32 - rhoOffset));</div>
<div class="line">                        var tLsw = (laneLsw &lt;&lt; rhoOffset) | (laneMsw &gt;&gt;&gt; (32 - rhoOffset));</div>
<div class="line">                    } <span class="keywordflow">else</span> <span class="comment">/* if (rhoOffset &gt;= 32) */</span> {</div>
<div class="line">                        var tMsw = (laneLsw &lt;&lt; (rhoOffset - 32)) | (laneMsw &gt;&gt;&gt; (64 - rhoOffset));</div>
<div class="line">                        var tLsw = (laneMsw &lt;&lt; (rhoOffset - 32)) | (laneLsw &gt;&gt;&gt; (64 - rhoOffset));</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Transpose lanes</span></div>
<div class="line">                    var TPiLane = T[PI_INDEXES[laneIndex]];</div>
<div class="line">                    TPiLane.high = tMsw;</div>
<div class="line">                    TPiLane.low  = tLsw;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Rho pi at x = y = 0</span></div>
<div class="line">                var T0 = T[0];</div>
<div class="line">                var state0 = state[0];</div>
<div class="line">                T0.high = state0.high;</div>
<div class="line">                T0.low  = state0.low;</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Chi</span></div>
<div class="line">                <span class="keywordflow">for</span> (var x = 0; x &lt; 5; x++) {</div>
<div class="line">                    <span class="keywordflow">for</span> (var y = 0; y &lt; 5; y++) {</div>
<div class="line">                        <span class="comment">// Shortcuts</span></div>
<div class="line">                        var laneIndex = x + 5 * y;</div>
<div class="line">                        var lane = state[laneIndex];</div>
<div class="line">                        var TLane = T[laneIndex];</div>
<div class="line">                        var Tx1Lane = T[((x + 1) % 5) + 5 * y];</div>
<div class="line">                        var Tx2Lane = T[((x + 2) % 5) + 5 * y];</div>
<div class="line"></div>
<div class="line">                        <span class="comment">// Mix rows</span></div>
<div class="line">                        lane.high = TLane.high ^ (~Tx1Lane.high &amp; Tx2Lane.high);</div>
<div class="line">                        lane.low  = TLane.low  ^ (~Tx1Lane.low  &amp; Tx2Lane.low);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Iota</span></div>
<div class="line">                var lane = state[0];</div>
<div class="line">                var roundConstant = ROUND_CONSTANTS[round];</div>
<div class="line">                lane.high ^= roundConstant.high;</div>
<div class="line">                lane.low  ^= roundConstant.low;;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        _doFinalize: <span class="keyword">function</span> () {</div>
<div class="line">            <span class="comment">// Shortcuts</span></div>
<div class="line">            var data = this._data;</div>
<div class="line">            var dataWords = data.words;</div>
<div class="line">            var nBitsTotal = this._nDataBytes * 8;</div>
<div class="line">            var nBitsLeft = data.sigBytes * 8;</div>
<div class="line">            var blockSizeBits = this.blockSize * 32;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Add padding</span></div>
<div class="line">            dataWords[nBitsLeft &gt;&gt;&gt; 5] |= 0x1 &lt;&lt; (24 - nBitsLeft % 32);</div>
<div class="line">            dataWords[((Math.ceil((nBitsLeft + 1) / blockSizeBits) * blockSizeBits) &gt;&gt;&gt; 5) - 1] |= 0x80;</div>
<div class="line">            data.sigBytes = dataWords.length * 4;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Hash final blocks</span></div>
<div class="line">            this._process();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Shortcuts</span></div>
<div class="line">            var state = this._state;</div>
<div class="line">            var outputLengthBytes = this.cfg.outputLength / 8;</div>
<div class="line">            var outputLengthLanes = outputLengthBytes / 8;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Squeeze</span></div>
<div class="line">            var hashWords = [];</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; outputLengthLanes; i++) {</div>
<div class="line">                <span class="comment">// Shortcuts</span></div>
<div class="line">                var lane = state[i];</div>
<div class="line">                var laneMsw = lane.high;</div>
<div class="line">                var laneLsw = lane.low;</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Swap endian</span></div>
<div class="line">                laneMsw = (</div>
<div class="line">                    (((laneMsw &lt;&lt; 8)  | (laneMsw &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                    (((laneMsw &lt;&lt; 24) | (laneMsw &gt;&gt;&gt; 8))  &amp; 0xff00ff00)</div>
<div class="line">                );</div>
<div class="line">                laneLsw = (</div>
<div class="line">                    (((laneLsw &lt;&lt; 8)  | (laneLsw &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                    (((laneLsw &lt;&lt; 24) | (laneLsw &gt;&gt;&gt; 8))  &amp; 0xff00ff00)</div>
<div class="line">                );</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Squeeze state to retrieve hash</span></div>
<div class="line">                hashWords.push(laneLsw);</div>
<div class="line">                hashWords.push(laneMsw);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Return final computed hash</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">new</span> WordArray.init(hashWords, outputLengthBytes);</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        clone: <span class="keyword">function</span> () {</div>
<div class="line">            var clone = Hasher.clone.call(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">            var state = clone._state = this._state.slice(0);</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 25; i++) {</div>
<div class="line">                state[i] = state[i].clone();</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> clone;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"></div>
<div class="line">    C.SHA3 = Hasher._createHelper(SHA3);</div>
<div class="line"></div>
<div class="line">    C.HmacSHA3 = Hasher._createHmacHelper(SHA3);</div>
<div class="line">}(Math));</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
