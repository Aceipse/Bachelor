<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WisR web applikation: C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/angular-sanitize.js</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WisR web applikation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/angular-sanitize.js</div>  </div>
</div><!--header-->
<div class="contents">
<p>&lt;file name="index.html"&gt; &lt;script&gt; angular.module('sanitizeExample', ['ngSanitize']) .controller('ExampleController', ['$scope', '$sce', function($scope, $sce) { $scope.snippet = '</p>
<p>an html<br />
' + '<em onmouseover="this.textContent=\&apos;PWN3D!\&apos;">click here</em><br />
' + 'snippet</p>
<p>'; $scope.deliberatelyTrustDangerousSnippet = function() { return $sce.trustAsHtml($scope.snippet); }; }]); &lt;/script&gt; </p><div ng-controller="ExampleController"> Snippet: &lt;textarea ng-model="snippet" cols="60" rows="3"&gt;&lt;/textarea&gt; </p><table class="doxtable">
<tr>
<td>Directive </td><td>How </td><td>Source </td><td>Rendered  </td></tr>
<tr id="bind-html-with-sanitize">
<td>ng-bind-html </td><td>Automatically uses $sanitize </td><td><pre>&lt;div ng-bind-html="snippet"&gt;<br />
&lt;/div&gt;</pre> </td><td><div ng-bind-html="snippet"></div>  </td></tr>
<tr id="bind-html-with-trust">
<td>ng-bind-html </td><td>Bypass $sanitize by explicitly trusting the dangerous value </td><td><pre>&lt;div ng-bind-html="deliberatelyTrustDangerousSnippet()"&gt;
&lt;/div&gt;</pre>  </td><td><div ng-bind-html="deliberatelyTrustDangerousSnippet()"></div>  </td></tr>
<tr id="bind-default">
<td>ng-bind </td><td>Automatically escapes </td><td><pre>&lt;div ng-bind="snippet"&gt;<br />
&lt;/div&gt;</pre> </td><td><div ng-bind="snippet"></div>  </td></tr>
</table>
</div><p> &lt;/file&gt; &lt;file name="protractor.js" type="protractor"&gt; it('should sanitize the html snippet by default', function() { expect(element(by.css('#bind-html-with-sanitize div')).getInnerHtml()). toBe('</p>
<p>an html<br />
<em>click here</em></p>
<p>'); });</p>
<p>it('should inline raw snippet if bound to a trusted value', function() { expect(element(by.css('#bind-html-with-trust div')).getInnerHtml()). toBe("&lt;p style=\"color:blue"&gt;an html<br />
" +
              "&lt;em onmouseover="this.textContent='PWN3D!'"&gt;click here<br />
" +
              "snippet</p>
<p>"); });</p>
<p>it('should escape snippet without any filter', function() { expect(element(by.css('#bind-default div')).getInnerHtml()). toBe("&amp;lt;p style=\"color:blue"&gt;an html<br />
" +
              "&lt;em onmouseover="this.textContent='PWN3D!'"&gt;click here&lt;/em&gt;<br />
" +
              "snippet&lt;/p&gt;"); });</p>
<p>it('should update', function() { element(by.model('snippet')).clear(); element(by.model('snippet')).sendKeys('new <b onclick="alert(1)">text</b>'); expect(element(by.css('#bind-html-with-sanitize div')).getInnerHtml()). toBe('new <b>text</b>'); expect(element(by.css('#bind-html-with-trust div')).getInnerHtml()).toBe( 'new <b onclick="alert(1)">text</b>'); expect(element(by.css('#bind-default div')).getInnerHtml()).toBe( "new &amp;lt;b onclick=\"alert(1)"&gt;text&lt;/b&gt;"); }); &lt;/file&gt; </p>
<div class="fragment"><div class="line"></div>
<div class="line">(<span class="keyword">function</span>(window, angular, undefined) {<span class="stringliteral">&#39;use strict&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></div>
<div class="line"><span class="comment"> *     Any commits to this file should be reviewed with security in mind.  *</span></div>
<div class="line"><span class="comment"> *   Changes to this file can potentially create security vulnerabilities. *</span></div>
<div class="line"><span class="comment"> *          An approval from 2 Core members with history of modifying      *</span></div>
<div class="line"><span class="comment"> *                         this file is required.                          *</span></div>
<div class="line"><span class="comment"> *                                                                         *</span></div>
<div class="line"><span class="comment"> *  Does the change somehow allow for arbitrary javascript to be executed? *</span></div>
<div class="line"><span class="comment"> *    Or allows for someone to change the prototype of built-in objects?   *</span></div>
<div class="line"><span class="comment"> *     Or gives undesired access to variables likes document or window?    *</span></div>
<div class="line"><span class="comment"> * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span></div>
<div class="line"></div>
<div class="line">var $sanitizeMinErr = angular.$$minErr(<span class="stringliteral">&#39;$sanitize&#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * HTML Parser By Misko Hevery (misko@hevery.com)</span></div>
<div class="line"><span class="comment"> * based on:  HTML Parser By John Resig (ejohn.org)</span></div>
<div class="line"><span class="comment"> * Original code by Erik Arvidsson, Mozilla Public License</span></div>
<div class="line"><span class="comment"> * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * // Use like so:</span></div>
<div class="line"><span class="comment"> * htmlParser(htmlString, {</span></div>
<div class="line"><span class="comment"> *     start: function(tag, attrs, unary) {},</span></div>
<div class="line"><span class="comment"> *     end: function(tag) {},</span></div>
<div class="line"><span class="comment"> *     chars: function(text) {},</span></div>
<div class="line"><span class="comment"> *     comment: function(text) {}</span></div>
<div class="line"><span class="comment"> * });</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">function</span> $SanitizeProvider() {</div>
<div class="line">  this.$get = [<span class="stringliteral">&#39;$$sanitizeUri&#39;</span>, <span class="keyword">function</span>($$sanitizeUri) {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">function</span>(html) {</div>
<div class="line">      var buf = [];</div>
<div class="line">      htmlParser(html, htmlSanitizeWriter(buf, <span class="keyword">function</span>(uri, isImage) {</div>
<div class="line">        <span class="keywordflow">return</span> !/^unsafe/.test($$sanitizeUri(uri, isImage));</div>
<div class="line">      }));</div>
<div class="line">      <span class="keywordflow">return</span> buf.join(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line">    };</div>
<div class="line">  }];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">function</span> sanitizeText(chars) {</div>
<div class="line">  var buf = [];</div>
<div class="line">  var writer = htmlSanitizeWriter(buf, angular.noop);</div>
<div class="line">  writer.chars(chars);</div>
<div class="line">  <span class="keywordflow">return</span> buf.join(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// Regular Expressions for parsing tags and attributes</span></div>
<div class="line">var START_TAG_REGEXP =</div>
<div class="line">       /^&lt;((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:<span class="stringliteral">&quot;[^&quot;</span>]*<span class="stringliteral">&quot;)|(?:&#39;[^&#39;]*&#39;)|[^&gt;\s]+))?)*)\s*(\/?)\s*(&gt;?)/,</span></div>
<div class="line"><span class="stringliteral">  END_TAG_REGEXP = /^&lt;\/\s*([\w:-]+)[^&gt;]*&gt;/,</span></div>
<div class="line"><span class="stringliteral">  ATTR_REGEXP = /([\w:-]+)(?:\s*=\s*(?:(?:&quot;</span>((?:[^<span class="stringliteral">&quot;])*)&quot;</span>)|(?:<span class="stringliteral">&#39;((?:[^&#39;</span>])*)<span class="stringliteral">&#39;)|([^&gt;\s]+)))?/g,</span></div>
<div class="line"><span class="stringliteral">  BEGIN_TAG_REGEXP = /^&lt;/,</span></div>
<div class="line"><span class="stringliteral">  BEGING_END_TAGE_REGEXP = /^&lt;\//,</span></div>
<div class="line"><span class="stringliteral">  COMMENT_REGEXP = /&lt;!--(.*?)--&gt;/g,</span></div>
<div class="line"><span class="stringliteral">  DOCTYPE_REGEXP = /&lt;!DOCTYPE([^&gt;]*?)&gt;/i,</span></div>
<div class="line"><span class="stringliteral">  CDATA_REGEXP = /&lt;!\[CDATA\[(.*?)]]&gt;/g,</span></div>
<div class="line"><span class="stringliteral">  SURROGATE_PAIR_REGEXP = /[\uD800-\uDBFF][\uDC00-\uDFFF]/g,</span></div>
<div class="line"><span class="stringliteral">  // Match everything outside of normal chars and &quot; (quote character)</span></div>
<div class="line"><span class="stringliteral">  NON_ALPHANUMERIC_REGEXP = /([^\#-~| |!])/g;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Good source of info about elements and attributes</span></div>
<div class="line"><span class="stringliteral">// http://dev.w3.org/html5/spec/Overview.html#semantics</span></div>
<div class="line"><span class="stringliteral">// http://simon.html5.org/html-elements</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Safe Void Elements - HTML5</span></div>
<div class="line"><span class="stringliteral">// http://dev.w3.org/html5/spec/Overview.html#void-elements</span></div>
<div class="line"><span class="stringliteral">var voidElements = makeMap(&quot;area,br,col,hr,img,wbr&quot;);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Elements that you can, intentionally, leave open (and which close themselves)</span></div>
<div class="line"><span class="stringliteral">// http://dev.w3.org/html5/spec/Overview.html#optional-tags</span></div>
<div class="line"><span class="stringliteral">var optionalEndTagBlockElements = makeMap(&quot;colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr&quot;),</span></div>
<div class="line"><span class="stringliteral">    optionalEndTagInlineElements = makeMap(&quot;rp,rt&quot;),</span></div>
<div class="line"><span class="stringliteral">    optionalEndTagElements = angular.extend({},</span></div>
<div class="line"><span class="stringliteral">                                            optionalEndTagInlineElements,</span></div>
<div class="line"><span class="stringliteral">                                            optionalEndTagBlockElements);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Safe Block Elements - HTML5</span></div>
<div class="line"><span class="stringliteral">var blockElements = angular.extend({}, optionalEndTagBlockElements, makeMap(&quot;address,article,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul&quot;));</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Inline Elements - HTML5</span></div>
<div class="line"><span class="stringliteral">var inlineElements = angular.extend({}, optionalEndTagInlineElements, makeMap(&quot;a,abbr,acronym,b,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;samp,small,span,strike,strong,sub,sup,time,tt,u,var&quot;));</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// SVG Elements</span></div>
<div class="line"><span class="stringliteral">// https://wiki.whatwg.org/wiki/Sanitization_rules#svg_Elements</span></div>
<div class="line"><span class="stringliteral">// Note: the elements animate,animateColor,animateMotion,animateTransform,set are intentionally omitted.</span></div>
<div class="line"><span class="stringliteral">// They can potentially allow for arbitrary javascript to be executed. See #11290</span></div>
<div class="line"><span class="stringliteral">var svgElements = makeMap(&quot;circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,&quot; +</span></div>
<div class="line"><span class="stringliteral">        &quot;radialGradient,rect,stop,svg,switch,text,title,tspan,use&quot;);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// Special Elements (can contain anything)</span></div>
<div class="line"><span class="stringliteral">var specialElements = makeMap(&quot;script,style&quot;);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">var validElements = angular.extend({},</span></div>
<div class="line"><span class="stringliteral">                                   voidElements,</span></div>
<div class="line"><span class="stringliteral">                                   blockElements,</span></div>
<div class="line"><span class="stringliteral">                                   inlineElements,</span></div>
<div class="line"><span class="stringliteral">                                   optionalEndTagElements,</span></div>
<div class="line"><span class="stringliteral">                                   svgElements);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">//Attributes that have href and hence need to be sanitized</span></div>
<div class="line"><span class="stringliteral">var uriAttrs = makeMap(&quot;background,cite,href,longdesc,src,usemap,xlink:href&quot;);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">var htmlAttrs = makeMap(&#39;</span>abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,<span class="keyword">class</span>,clear,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>valign,value,vspace,width<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">// SVG attributes (without &quot;id&quot; and &quot;name&quot; attributes)</span></div>
<div class="line"><span class="stringliteral">// https://wiki.whatwg.org/wiki/Sanitization_rules#svg_Attributes</span></div>
<div class="line"><span class="stringliteral">var svgAttrs = makeMap(&#39;</span>accent-height,accumulate,additive,alphabetic,arabic-form,ascent,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>baseProfile,bbox,begin,by,calcMode,cap-height,<span class="keyword">class</span>,color,color-rendering,content,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,<span class="stringliteral">&#39; +</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan<span class="stringliteral">&#39;, true);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">var validAttrs = angular.extend({},</span></div>
<div class="line"><span class="stringliteral">                                uriAttrs,</span></div>
<div class="line"><span class="stringliteral">                                svgAttrs,</span></div>
<div class="line"><span class="stringliteral">                                htmlAttrs);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">function makeMap(str, lowercaseKeys) {</span></div>
<div class="line"><span class="stringliteral">  var obj = {}, items = str.split(&#39;</span>,<span class="stringliteral">&#39;), i;</span></div>
<div class="line"><span class="stringliteral">  for (i = 0; i &lt; items.length; i++) {</span></div>
<div class="line"><span class="stringliteral">    obj[lowercaseKeys ? angular.lowercase(items[i]) : items[i]] = true;</span></div>
<div class="line"><span class="stringliteral">  }</span></div>
<div class="line"><span class="stringliteral">  return obj;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">function htmlParser(html, handler) {</span></div>
<div class="line"><span class="stringliteral">  if (typeof html !== &#39;</span><span class="keywordtype">string</span><span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="stringliteral">    if (html === null || typeof html === &#39;</span>undefined<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="stringliteral">      html = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="stringliteral">    } else {</span></div>
<div class="line"><span class="stringliteral">      html = &#39;</span><span class="stringliteral">&#39; + html;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">  }</span></div>
<div class="line"><span class="stringliteral">  var index, chars, match, stack = [], last = html, text;</span></div>
<div class="line"><span class="stringliteral">  stack.last = function() { return stack[stack.length - 1]; };</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">  while (html) {</span></div>
<div class="line"><span class="stringliteral">    text = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="stringliteral">    chars = true;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    // Make sure we&#39;</span>re not in a script or style element</div>
<div class="line">    <span class="keywordflow">if</span> (!stack.last() || !specialElements[stack.last()]) {</div>
<div class="line"></div>
<div class="line">      <span class="comment">// Comment</span></div>
<div class="line">      <span class="keywordflow">if</span> (html.indexOf(<span class="stringliteral">&quot;&lt;!--&quot;</span>) === 0) {</div>
<div class="line">        <span class="comment">// comments containing -- are not allowed unless they terminate the comment</span></div>
<div class="line">        index = html.indexOf(<span class="stringliteral">&quot;--&quot;</span>, 4);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (index &gt;= 0 &amp;&amp; html.lastIndexOf(<span class="stringliteral">&quot;--&gt;&quot;</span>, index) === index) {</div>
<div class="line">          <span class="keywordflow">if</span> (handler.comment) handler.comment(html.substring(4, index));</div>
<div class="line">          html = html.substring(index + 3);</div>
<div class="line">          chars = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="comment">// DOCTYPE</span></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DOCTYPE_REGEXP.test(html)) {</div>
<div class="line">        match = html.match(DOCTYPE_REGEXP);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (match) {</div>
<div class="line">          html = html.replace(match[0], <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line">          chars = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="comment">// end tag</span></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BEGING_END_TAGE_REGEXP.test(html)) {</div>
<div class="line">        match = html.match(END_TAG_REGEXP);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (match) {</div>
<div class="line">          html = html.substring(match[0].length);</div>
<div class="line">          match[0].replace(END_TAG_REGEXP, parseEndTag);</div>
<div class="line">          chars = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">      <span class="comment">// start tag</span></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BEGIN_TAG_REGEXP.test(html)) {</div>
<div class="line">        match = html.match(START_TAG_REGEXP);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (match) {</div>
<div class="line">          <span class="comment">// We only have a valid start-tag if there is a &#39;&gt;&#39;.</span></div>
<div class="line">          <span class="keywordflow">if</span> (match[4]) {</div>
<div class="line">            html = html.substring(match[0].length);</div>
<div class="line">            match[0].replace(START_TAG_REGEXP, parseStartTag);</div>
<div class="line">          }</div>
<div class="line">          chars = <span class="keyword">false</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          <span class="comment">// no ending tag found --- this piece should be encoded as an entity.</span></div>
<div class="line">          text += <span class="charliteral">&#39;&lt;&#39;</span>;</div>
<div class="line">          html = html.substring(1);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (chars) {</div>
<div class="line">        index = html.indexOf(<span class="stringliteral">&quot;&lt;&quot;</span>);</div>
<div class="line"></div>
<div class="line">        text += index &lt; 0 ? html : html.substring(0, index);</div>
<div class="line">        html = index &lt; 0 ? <span class="stringliteral">&quot;&quot;</span> : html.substring(index);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (handler.chars) handler.chars(decodeEntities(text));</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">// IE versions 9 and 10 do not understand the regex &#39;[^]&#39;, so using a workaround with [\W\w].</span></div>
<div class="line">      html = html.replace(<span class="keyword">new</span> RegExp(<span class="stringliteral">&quot;([\\W\\w]*)&lt;\\s*\\/\\s*&quot;</span> + stack.last() + <span class="stringliteral">&quot;[^&gt;]*&gt;&quot;</span>, <span class="charliteral">&#39;i&#39;</span>),</div>
<div class="line">        <span class="keyword">function</span>(all, text) {</div>
<div class="line">          text = text.replace(COMMENT_REGEXP, <span class="stringliteral">&quot;$1&quot;</span>).replace(CDATA_REGEXP, <span class="stringliteral">&quot;$1&quot;</span>);</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> (handler.chars) handler.chars(decodeEntities(text));</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">      });</div>
<div class="line"></div>
<div class="line">      parseEndTag(<span class="stringliteral">&quot;&quot;</span>, stack.last());</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (html == last) {</div>
<div class="line">      <span class="keywordflow">throw</span> $sanitizeMinErr(<span class="stringliteral">&#39;badparse&#39;</span>, <span class="stringliteral">&quot;The sanitizer was unable to parse the following block &quot;</span> +</div>
<div class="line">                                        <span class="stringliteral">&quot;of html: {0}&quot;</span>, html);</div>
<div class="line">    }</div>
<div class="line">    last = html;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Clean up any remaining tags</span></div>
<div class="line">  parseEndTag();</div>
<div class="line"></div>
<div class="line">  <span class="keyword">function</span> parseStartTag(tag, tagName, rest, unary) {</div>
<div class="line">    tagName = angular.lowercase(tagName);</div>
<div class="line">    <span class="keywordflow">if</span> (blockElements[tagName]) {</div>
<div class="line">      <span class="keywordflow">while</span> (stack.last() &amp;&amp; inlineElements[stack.last()]) {</div>
<div class="line">        parseEndTag(<span class="stringliteral">&quot;&quot;</span>, stack.last());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (optionalEndTagElements[tagName] &amp;&amp; stack.last() == tagName) {</div>
<div class="line">      parseEndTag(<span class="stringliteral">&quot;&quot;</span>, tagName);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    unary = voidElements[tagName] || !!unary;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!unary) {</div>
<div class="line">      stack.push(tagName);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    var attrs = {};</div>
<div class="line"></div>
<div class="line">    rest.replace(ATTR_REGEXP,</div>
<div class="line">      <span class="keyword">function</span>(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {</div>
<div class="line">        var value = doubleQuotedValue</div>
<div class="line">          || singleQuotedValue</div>
<div class="line">          || unquotedValue</div>
<div class="line">          || <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"></div>
<div class="line">        attrs[name] = decodeEntities(value);</div>
<div class="line">    });</div>
<div class="line">    <span class="keywordflow">if</span> (handler.start) handler.start(tagName, attrs, unary);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keyword">function</span> parseEndTag(tag, tagName) {</div>
<div class="line">    var pos = 0, i;</div>
<div class="line">    tagName = angular.lowercase(tagName);</div>
<div class="line">    <span class="keywordflow">if</span> (tagName) {</div>
<div class="line">      <span class="comment">// Find the closest opened tag of the same type</span></div>
<div class="line">      <span class="keywordflow">for</span> (pos = stack.length - 1; pos &gt;= 0; pos--) {</div>
<div class="line">        <span class="keywordflow">if</span> (stack[pos] == tagName) <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (pos &gt;= 0) {</div>
<div class="line">      <span class="comment">// Close all the open elements, up the stack</span></div>
<div class="line">      <span class="keywordflow">for</span> (i = stack.length - 1; i &gt;= pos; i--)</div>
<div class="line">        <span class="keywordflow">if</span> (handler.end) handler.end(stack[i]);</div>
<div class="line"></div>
<div class="line">      <span class="comment">// Remove the open elements from the stack</span></div>
<div class="line">      stack.length = pos;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">var hiddenPre=document.createElement(<span class="stringliteral">&quot;pre&quot;</span>);</div>
<div class="line"><span class="keyword">function</span> decodeEntities(value) {</div>
<div class="line">  <span class="keywordflow">if</span> (!value) { <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>; }</div>
<div class="line"></div>
<div class="line">  hiddenPre.innerHTML = value.replace(/&lt;/g,<span class="stringliteral">&quot;&amp;lt;&quot;</span>);</div>
<div class="line">  <span class="comment">// innerText depends on styling as it doesn&#39;t display hidden elements.</span></div>
<div class="line">  <span class="comment">// Therefore, it&#39;s better to use textContent not to cause unnecessary reflows.</span></div>
<div class="line">  <span class="keywordflow">return</span> hiddenPre.textContent;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">function</span> encodeEntities(value) {</div>
<div class="line">  <span class="keywordflow">return</span> value.</div>
<div class="line">    replace(/&amp;/g, <span class="stringliteral">&#39;&amp;amp;&#39;</span>).</div>
<div class="line">    replace(SURROGATE_PAIR_REGEXP, <span class="keyword">function</span>(value) {</div>
<div class="line">      var hi = value.charCodeAt(0);</div>
<div class="line">      var low = value.charCodeAt(1);</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&#39;&amp;#&#39;</span> + (((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000) + <span class="charliteral">&#39;;&#39;</span>;</div>
<div class="line">    }).</div>
<div class="line">    replace(NON_ALPHANUMERIC_REGEXP, <span class="keyword">function</span>(value) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&#39;&amp;#&#39;</span> + value.charCodeAt(0) + <span class="charliteral">&#39;;&#39;</span>;</div>
<div class="line">    }).</div>
<div class="line">    replace(/&lt;/g, <span class="stringliteral">&#39;&amp;lt;&#39;</span>).</div>
<div class="line">    replace(/&gt;/g, <span class="stringliteral">&#39;&amp;gt;&#39;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">function</span> htmlSanitizeWriter(buf, uriValidator) {</div>
<div class="line">  var ignore = <span class="keyword">false</span>;</div>
<div class="line">  var out = angular.bind(buf, buf.push);</div>
<div class="line">  <span class="keywordflow">return</span> {</div>
<div class="line">    start: <span class="keyword">function</span>(tag, attrs, unary) {</div>
<div class="line">      tag = angular.lowercase(tag);</div>
<div class="line">      <span class="keywordflow">if</span> (!ignore &amp;&amp; specialElements[tag]) {</div>
<div class="line">        ignore = tag;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (!ignore &amp;&amp; validElements[tag] === <span class="keyword">true</span>) {</div>
<div class="line">        out(<span class="charliteral">&#39;&lt;&#39;</span>);</div>
<div class="line">        out(tag);</div>
<div class="line">        angular.forEach(attrs, <span class="keyword">function</span>(value, key) {</div>
<div class="line">          var lkey=angular.lowercase(key);</div>
<div class="line">          var isImage = (tag === <span class="stringliteral">&#39;img&#39;</span> &amp;&amp; lkey === <span class="stringliteral">&#39;src&#39;</span>) || (lkey === <span class="stringliteral">&#39;background&#39;</span>);</div>
<div class="line">          <span class="keywordflow">if</span> (validAttrs[lkey] === <span class="keyword">true</span> &amp;&amp;</div>
<div class="line">            (uriAttrs[lkey] !== <span class="keyword">true</span> || uriValidator(value, isImage))) {</div>
<div class="line">            out(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line">            out(key);</div>
<div class="line">            out(<span class="stringliteral">&#39;=&quot;&#39;</span>);</div>
<div class="line">            out(encodeEntities(value));</div>
<div class="line">            out(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line">          }</div>
<div class="line">        });</div>
<div class="line">        out(unary ? <span class="stringliteral">&#39;/&gt;&#39;</span> : <span class="charliteral">&#39;&gt;&#39;</span>);</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    end: <span class="keyword">function</span>(tag) {</div>
<div class="line">        tag = angular.lowercase(tag);</div>
<div class="line">        <span class="keywordflow">if</span> (!ignore &amp;&amp; validElements[tag] === <span class="keyword">true</span>) {</div>
<div class="line">          out(<span class="stringliteral">&#39;&lt;/&#39;</span>);</div>
<div class="line">          out(tag);</div>
<div class="line">          out(<span class="charliteral">&#39;&gt;&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (tag == ignore) {</div>
<div class="line">          ignore = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">      },</div>
<div class="line">    chars: <span class="keyword">function</span>(chars) {</div>
<div class="line">        <span class="keywordflow">if</span> (!ignore) {</div>
<div class="line">          out(encodeEntities(chars));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">  };</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// define ngSanitize module and register $sanitize service</span></div>
<div class="line">angular.module(<span class="stringliteral">&#39;ngSanitize&#39;</span>, []).provider(<span class="stringliteral">&#39;$sanitize&#39;</span>, $SanitizeProvider);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* global sanitizeText: false */</span></div>
<div class="line"></div>
<div class="line">angular.module(<span class="stringliteral">&#39;ngSanitize&#39;</span>).filter(<span class="stringliteral">&#39;linky&#39;</span>, [<span class="stringliteral">&#39;$sanitize&#39;</span>, <span class="keyword">function</span>($sanitize) {</div>
<div class="line">  var LINKY_URL_REGEXP =</div>
<div class="line">        /((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}&lt;&gt;<span class="stringliteral">&quot;\u201d\u2019]/i,</span></div>
<div class="line"><span class="stringliteral">      MAILTO_REGEXP = /^mailto:/i;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">  return function(text, target) {</span></div>
<div class="line"><span class="stringliteral">    if (!text) return text;</span></div>
<div class="line"><span class="stringliteral">    var match;</span></div>
<div class="line"><span class="stringliteral">    var raw = text;</span></div>
<div class="line"><span class="stringliteral">    var html = [];</span></div>
<div class="line"><span class="stringliteral">    var url;</span></div>
<div class="line"><span class="stringliteral">    var i;</span></div>
<div class="line"><span class="stringliteral">    while ((match = raw.match(LINKY_URL_REGEXP))) {</span></div>
<div class="line"><span class="stringliteral">      // We can not end in these as they are sometimes found at the end of the sentence</span></div>
<div class="line"><span class="stringliteral">      url = match[0];</span></div>
<div class="line"><span class="stringliteral">      // if we did not match ftp/http/www/mailto then assume mailto</span></div>
<div class="line"><span class="stringliteral">      if (!match[2] &amp;&amp; !match[4]) {</span></div>
<div class="line"><span class="stringliteral">        url = (match[3] ? &#39;http://&#39; : &#39;mailto:&#39;) + url;</span></div>
<div class="line"><span class="stringliteral">      }</span></div>
<div class="line"><span class="stringliteral">      i = match.index;</span></div>
<div class="line"><span class="stringliteral">      addText(raw.substr(0, i));</span></div>
<div class="line"><span class="stringliteral">      addLink(url, match[0].replace(MAILTO_REGEXP, &#39;&#39;));</span></div>
<div class="line"><span class="stringliteral">      raw = raw.substring(i + match[0].length);</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    addText(raw);</span></div>
<div class="line"><span class="stringliteral">    return $sanitize(html.join(&#39;&#39;));</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    function addText(text) {</span></div>
<div class="line"><span class="stringliteral">      if (!text) {</span></div>
<div class="line"><span class="stringliteral">        return;</span></div>
<div class="line"><span class="stringliteral">      }</span></div>
<div class="line"><span class="stringliteral">      html.push(sanitizeText(text));</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    function addLink(url, text) {</span></div>
<div class="line"><span class="stringliteral">      html.push(&#39;&lt;a &#39;);</span></div>
<div class="line"><span class="stringliteral">      if (angular.isDefined(target)) {</span></div>
<div class="line"><span class="stringliteral">        html.push(&#39;target=&quot;</span><span class="stringliteral">&#39;,</span></div>
<div class="line"><span class="stringliteral">                  target,</span></div>
<div class="line"><span class="stringliteral">                  &#39;</span><span class="stringliteral">&quot; &#39;);</span></div>
<div class="line"><span class="stringliteral">      }</span></div>
<div class="line"><span class="stringliteral">      html.push(&#39;href=&quot;</span><span class="stringliteral">&#39;,</span></div>
<div class="line"><span class="stringliteral">                url.replace(/&quot;/g, &#39;</span>&amp;quot;<span class="stringliteral">&#39;),</span></div>
<div class="line"><span class="stringliteral">                &#39;</span><span class="stringliteral">&quot;&gt;&#39;);</span></div>
<div class="line"><span class="stringliteral">      addText(text);</span></div>
<div class="line"><span class="stringliteral">      html.push(&#39;&lt;/a&gt;&#39;);</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">  };</span></div>
<div class="line"><span class="stringliteral">}]);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">})(window, window.angular);</span></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
