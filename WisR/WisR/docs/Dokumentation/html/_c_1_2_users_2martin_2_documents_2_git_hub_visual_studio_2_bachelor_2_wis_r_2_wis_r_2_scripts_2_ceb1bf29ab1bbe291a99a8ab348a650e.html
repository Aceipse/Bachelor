<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WisR web applikation: C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/CryptoJS/components/rabbit.js</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WisR web applikation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">C:/Users/martin/Documents/GitHubVisualStudio/Bachelor/WisR/WisR/Scripts/CryptoJS/components/rabbit.js</div>  </div>
</div><!--header-->
<div class="contents">
<p>Shortcut functions to the cipher's object interface.</p>
<pre class="fragment">var ciphertext = CryptoJS.Rabbit.encrypt(message, key, cfg);
var plaintext  = CryptoJS.Rabbit.decrypt(ciphertext, key, cfg);</pre><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">CryptoJS v3.1.2</span></div>
<div class="line"><span class="comment">code.google.com/p/crypto-js</span></div>
<div class="line"><span class="comment">(c) 2009-2013 by Jeff Mott. All rights reserved.</span></div>
<div class="line"><span class="comment">code.google.com/p/crypto-js/wiki/License</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line">(<span class="keyword">function</span> () {</div>
<div class="line">    <span class="comment">// Shortcuts</span></div>
<div class="line">    var C = CryptoJS;</div>
<div class="line">    var C_lib = C.lib;</div>
<div class="line">    var StreamCipher = C_lib.StreamCipher;</div>
<div class="line">    var C_algo = C.algo;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Reusable objects</span></div>
<div class="line">    var S  = [];</div>
<div class="line">    var C_ = [];</div>
<div class="line">    var G  = [];</div>
<div class="line"></div>
<div class="line">    var Rabbit = C_algo.Rabbit = StreamCipher.extend({</div>
<div class="line">        _doReset: <span class="keyword">function</span> () {</div>
<div class="line">            <span class="comment">// Shortcuts</span></div>
<div class="line">            var K = this._key.words;</div>
<div class="line">            var iv = this.cfg.iv;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Swap endian</span></div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 4; i++) {</div>
<div class="line">                K[i] = (((K[i] &lt;&lt; 8)  | (K[i] &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                       (((K[i] &lt;&lt; 24) | (K[i] &gt;&gt;&gt; 8))  &amp; 0xff00ff00);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Generate initial state values</span></div>
<div class="line">            var X = this._X = [</div>
<div class="line">                K[0], (K[3] &lt;&lt; 16) | (K[2] &gt;&gt;&gt; 16),</div>
<div class="line">                K[1], (K[0] &lt;&lt; 16) | (K[3] &gt;&gt;&gt; 16),</div>
<div class="line">                K[2], (K[1] &lt;&lt; 16) | (K[0] &gt;&gt;&gt; 16),</div>
<div class="line">                K[3], (K[2] &lt;&lt; 16) | (K[1] &gt;&gt;&gt; 16)</div>
<div class="line">            ];</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Generate initial counter values</span></div>
<div class="line">            var C = this._C = [</div>
<div class="line">                (K[2] &lt;&lt; 16) | (K[2] &gt;&gt;&gt; 16), (K[0] &amp; 0xffff0000) | (K[1] &amp; 0x0000ffff),</div>
<div class="line">                (K[3] &lt;&lt; 16) | (K[3] &gt;&gt;&gt; 16), (K[1] &amp; 0xffff0000) | (K[2] &amp; 0x0000ffff),</div>
<div class="line">                (K[0] &lt;&lt; 16) | (K[0] &gt;&gt;&gt; 16), (K[2] &amp; 0xffff0000) | (K[3] &amp; 0x0000ffff),</div>
<div class="line">                (K[1] &lt;&lt; 16) | (K[1] &gt;&gt;&gt; 16), (K[3] &amp; 0xffff0000) | (K[0] &amp; 0x0000ffff)</div>
<div class="line">            ];</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Carry bit</span></div>
<div class="line">            this._b = 0;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Iterate the system four times</span></div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 4; i++) {</div>
<div class="line">                nextState.call(<span class="keyword">this</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Modify the counters</span></div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 8; i++) {</div>
<div class="line">                C[i] ^= X[(i + 4) &amp; 7];</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// IV setup</span></div>
<div class="line">            <span class="keywordflow">if</span> (iv) {</div>
<div class="line">                <span class="comment">// Shortcuts</span></div>
<div class="line">                var IV = iv.words;</div>
<div class="line">                var IV_0 = IV[0];</div>
<div class="line">                var IV_1 = IV[1];</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Generate four subvectors</span></div>
<div class="line">                var i0 = (((IV_0 &lt;&lt; 8) | (IV_0 &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) | (((IV_0 &lt;&lt; 24) | (IV_0 &gt;&gt;&gt; 8)) &amp; 0xff00ff00);</div>
<div class="line">                var i2 = (((IV_1 &lt;&lt; 8) | (IV_1 &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) | (((IV_1 &lt;&lt; 24) | (IV_1 &gt;&gt;&gt; 8)) &amp; 0xff00ff00);</div>
<div class="line">                var i1 = (i0 &gt;&gt;&gt; 16) | (i2 &amp; 0xffff0000);</div>
<div class="line">                var i3 = (i2 &lt;&lt; 16)  | (i0 &amp; 0x0000ffff);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Modify counter values</span></div>
<div class="line">                C[0] ^= i0;</div>
<div class="line">                C[1] ^= i1;</div>
<div class="line">                C[2] ^= i2;</div>
<div class="line">                C[3] ^= i3;</div>
<div class="line">                C[4] ^= i0;</div>
<div class="line">                C[5] ^= i1;</div>
<div class="line">                C[6] ^= i2;</div>
<div class="line">                C[7] ^= i3;</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Iterate the system four times</span></div>
<div class="line">                <span class="keywordflow">for</span> (var i = 0; i &lt; 4; i++) {</div>
<div class="line">                    nextState.call(<span class="keyword">this</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        _doProcessBlock: <span class="keyword">function</span> (M, offset) {</div>
<div class="line">            <span class="comment">// Shortcut</span></div>
<div class="line">            var X = this._X;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Iterate the system</span></div>
<div class="line">            nextState.call(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Generate four keystream words</span></div>
<div class="line">            S[0] = X[0] ^ (X[5] &gt;&gt;&gt; 16) ^ (X[3] &lt;&lt; 16);</div>
<div class="line">            S[1] = X[2] ^ (X[7] &gt;&gt;&gt; 16) ^ (X[5] &lt;&lt; 16);</div>
<div class="line">            S[2] = X[4] ^ (X[1] &gt;&gt;&gt; 16) ^ (X[7] &lt;&lt; 16);</div>
<div class="line">            S[3] = X[6] ^ (X[3] &gt;&gt;&gt; 16) ^ (X[1] &lt;&lt; 16);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; 4; i++) {</div>
<div class="line">                <span class="comment">// Swap endian</span></div>
<div class="line">                S[i] = (((S[i] &lt;&lt; 8)  | (S[i] &gt;&gt;&gt; 24)) &amp; 0x00ff00ff) |</div>
<div class="line">                       (((S[i] &lt;&lt; 24) | (S[i] &gt;&gt;&gt; 8))  &amp; 0xff00ff00);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Encrypt</span></div>
<div class="line">                M[offset + i] ^= S[i];</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        blockSize: 128/32,</div>
<div class="line"></div>
<div class="line">        ivSize: 64/32</div>
<div class="line">    });</div>
<div class="line"></div>
<div class="line">    <span class="keyword">function</span> nextState() {</div>
<div class="line">        <span class="comment">// Shortcuts</span></div>
<div class="line">        var X = this._X;</div>
<div class="line">        var C = this._C;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Save old counter values</span></div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; 8; i++) {</div>
<div class="line">            C_[i] = C[i];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Calculate new counter values</span></div>
<div class="line">        C[0] = (C[0] + 0x4d34d34d + this._b) | 0;</div>
<div class="line">        C[1] = (C[1] + 0xd34d34d3 + ((C[0] &gt;&gt;&gt; 0) &lt; (C_[0] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[2] = (C[2] + 0x34d34d34 + ((C[1] &gt;&gt;&gt; 0) &lt; (C_[1] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[3] = (C[3] + 0x4d34d34d + ((C[2] &gt;&gt;&gt; 0) &lt; (C_[2] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[4] = (C[4] + 0xd34d34d3 + ((C[3] &gt;&gt;&gt; 0) &lt; (C_[3] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[5] = (C[5] + 0x34d34d34 + ((C[4] &gt;&gt;&gt; 0) &lt; (C_[4] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[6] = (C[6] + 0x4d34d34d + ((C[5] &gt;&gt;&gt; 0) &lt; (C_[5] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        C[7] = (C[7] + 0xd34d34d3 + ((C[6] &gt;&gt;&gt; 0) &lt; (C_[6] &gt;&gt;&gt; 0) ? 1 : 0)) | 0;</div>
<div class="line">        this._b = (C[7] &gt;&gt;&gt; 0) &lt; (C_[7] &gt;&gt;&gt; 0) ? 1 : 0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Calculate the g-values</span></div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; 8; i++) {</div>
<div class="line">            var gx = X[i] + C[i];</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Construct high and low argument for squaring</span></div>
<div class="line">            var ga = gx &amp; 0xffff;</div>
<div class="line">            var gb = gx &gt;&gt;&gt; 16;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Calculate high and low result of squaring</span></div>
<div class="line">            var gh = ((((ga * ga) &gt;&gt;&gt; 17) + ga * gb) &gt;&gt;&gt; 15) + gb * gb;</div>
<div class="line">            var gl = (((gx &amp; 0xffff0000) * gx) | 0) + (((gx &amp; 0x0000ffff) * gx) | 0);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// High XOR low</span></div>
<div class="line">            G[i] = gh ^ gl;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Calculate new state values</span></div>
<div class="line">        X[0] = (G[0] + ((G[7] &lt;&lt; 16) | (G[7] &gt;&gt;&gt; 16)) + ((G[6] &lt;&lt; 16) | (G[6] &gt;&gt;&gt; 16))) | 0;</div>
<div class="line">        X[1] = (G[1] + ((G[0] &lt;&lt; 8)  | (G[0] &gt;&gt;&gt; 24)) + G[7]) | 0;</div>
<div class="line">        X[2] = (G[2] + ((G[1] &lt;&lt; 16) | (G[1] &gt;&gt;&gt; 16)) + ((G[0] &lt;&lt; 16) | (G[0] &gt;&gt;&gt; 16))) | 0;</div>
<div class="line">        X[3] = (G[3] + ((G[2] &lt;&lt; 8)  | (G[2] &gt;&gt;&gt; 24)) + G[1]) | 0;</div>
<div class="line">        X[4] = (G[4] + ((G[3] &lt;&lt; 16) | (G[3] &gt;&gt;&gt; 16)) + ((G[2] &lt;&lt; 16) | (G[2] &gt;&gt;&gt; 16))) | 0;</div>
<div class="line">        X[5] = (G[5] + ((G[4] &lt;&lt; 8)  | (G[4] &gt;&gt;&gt; 24)) + G[3]) | 0;</div>
<div class="line">        X[6] = (G[6] + ((G[5] &lt;&lt; 16) | (G[5] &gt;&gt;&gt; 16)) + ((G[4] &lt;&lt; 16) | (G[4] &gt;&gt;&gt; 16))) | 0;</div>
<div class="line">        X[7] = (G[7] + ((G[6] &lt;&lt; 8)  | (G[6] &gt;&gt;&gt; 24)) + G[5]) | 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    C.Rabbit = StreamCipher._createHelper(Rabbit);</div>
<div class="line">}());</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
