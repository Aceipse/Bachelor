<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WisR web applikation: Istanbul - a JS code coverage tool written in JS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WisR web applikation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Istanbul - a JS code coverage tool written in JS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://travis-ci.org/gotwarlost/istanbul">![Build Status](https://secure.travis-ci.org/gotwarlost/istanbul.png)</a> <a href="https://gemnasium.com/gotwarlost/istanbul">![Dependency Status](https://gemnasium.com/gotwarlost/istanbul.png)</a> <a href="https://coveralls.io/r/gotwarlost/istanbul?branch=master">![Coverage Status](https://img.shields.io/coveralls/gotwarlost/istanbul.svg)</a> <a href="https://www.bithound.io/github/gotwarlost/istanbul">![bitHound Score](https://www.bithound.io/github/gotwarlost/istanbul/badges/score.svg)</a></p>
<p><a href="https://nodei.co/npm/istanbul/">![NPM](https://nodei.co/npm/istanbul.png?downloads=true)</a></p>
<ul>
<li><a href="#features">Features and use cases</a></li>
<li><a href="#getting-started">Getting started and configuration</a></li>
<li><a href="#the-command-line">The command line</a></li>
<li><a href="#ignoring-code-for-coverage">Ignoring code for coverage</a></li>
<li><a href="#api">API</a></li>
<li>https://github.com/gotwarlost/istanbul/blob/master/CHANGELOG.md "Changelog"</li>
<li><a href="#license">License and credits</a></li>
</ul>
<h3>Features</h3>
<ul>
<li>All-javascript instrumentation library that tracks <b>statement, branch, and function coverage</b>.</li>
<li><b>Module loader hooks</b> to instrument code on the fly</li>
<li><b>Command line tools</b> to run node unit tests "with coverage turned on" and no cooperation whatsoever from the test runner</li>
<li>Multiple report formats: <b>HTML</b>, <b>LCOV</b>, <b>Cobertura</b> and more.</li>
<li>Ability to use as <a href="https://github.com/gotwarlost/istanbul-middleware">middleware</a> when serving JS files that need to be tested on the browser.</li>
<li>Can be used on the <b>command line</b> as well as a <b>library</b></li>
<li>Based on the awesome <code>esprima</code> parser and the equally awesome <code>escodegen</code> code generator</li>
<li>Well-tested on node (prev, current and next versions) and the browser (instrumentation library only)</li>
</ul>
<h3>Use cases</h3>
<p>Supports the following use cases and more</p>
<ul>
<li>transparent coverage of nodejs unit tests</li>
<li>instrumentation/ reporting of files in batch mode for browser tests</li>
<li>Server side code coverage for nodejs by embedding it as <a href="https://github.com/gotwarlost/istanbul-middleware">custom middleware</a></li>
</ul>
<h3>Getting started</h3>
<pre class="fragment">$ npm install -g istanbul
</pre><p>The best way to see it in action is to run node unit tests. Say you have a test script <code>test.js</code> that runs all tests for your node project without coverage.</p>
<p>Simply: </p><pre class="fragment">$ cd /path/to/your/source/root
$ istanbul cover test.js
</pre><p>and this should produce a <code>coverage.json</code>, <code>lcov.info</code> and <code>lcov-report/*html</code> under <code>./coverage</code></p>
<p>Sample of code coverage reports produced by this tool (for this tool!):</p>
<p><a href="http://gotwarlost.github.com/istanbul/public/coverage/lcov-report/index.html">HTML reports</a></p>
<h3>Configuring</h3>
<p>Drop a <code>.istanbul.yml</code> file at the top of the source tree to configure istanbul. <code>istanbul help config</code> tells you more about the config file format.</p>
<h3>The command line</h3>
<pre class="fragment">$ istanbul help
</pre><p>gives you detailed help on all commands.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Usage: istanbul help config | &lt;command&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;`config` provides help with istanbul configuration</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Available commands are:</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;      check-coverage</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;              checks overall/per-file coverage against thresholds from coverage</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;              JSON files. Exits 1 if thresholds are not met, 0 otherwise</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      cover   transparently adds coverage information to a node command. Saves</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;              coverage.json and reports at the end of execution</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      help    shows help</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      instrument</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;              instruments a file or a directory tree and writes the</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;              instrumented code to the desired output location</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      report  writes reports for coverage JSON objects produced in a previous</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;              run</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      test    cover a node command only when npm_config_coverage is set. Use in</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;              an `npm test` script for conditional coverage</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;Command names can be abbreviated as long as the abbreviation is unambiguous</div>
</div><!-- fragment --><p>To get detailed help for a command and what command-line options it supports, run: </p><pre class="fragment">istanbul help &lt;command&gt;
</pre><p>(Most of the command line options are not covered in this document.)</p>
<h4>The <code>cover</code> command</h4>
<pre class="fragment">$ istanbul cover my-test-script.js -- my test args
# note the -- between the command name and the arguments to be passed
</pre><p>The <code>cover</code> command can be used to get a coverage object and reports for any arbitrary node script. By default, coverage information is written under <code>./coverage</code> - this can be changed using command-line options.</p>
<p>The <code>cover</code> command can also be passed an optional <code>--handle-sigint</code> flag to enable writing reports when a user triggers a manual SIGINT of the process that is being covered. This can be useful when you are generating coverage for a long lived process.</p>
<h4>The <code>test</code> command</h4>
<p>The <code>test</code> command has almost the same behavior as the <code>cover</code> command, except that it skips coverage unless the <code>npm_config_coverage</code> environment variable is set.</p>
<p><b>This command is deprecated</b> since the latest versions of npm do not seem to set the <code>npm_config_coverage</code> variable.</p>
<h4>The <code>instrument</code> command</h4>
<p>Instruments a single JS file or an entire directory tree and produces an output directory tree with instrumented code. This should not be required for running node unit tests but is useful for tests to be run on the browser.</p>
<h4>The <code>report</code> command</h4>
<p>Writes reports using <code>coverage*.json</code> files as the source of coverage information. Reports are available in multiple formats and can be individually configured using the istanbul config file. See <code>istanbul help report</code> for more details.</p>
<h4>The <code>check-coverage</code> command</h4>
<p>Checks the coverage of statements, functions, branches, and lines against the provided thresholds. Positive thresholds are taken to be the minimum percentage required and negative numbers are taken to be the number of uncovered entities allowed.</p>
<h3>Ignoring code for coverage</h3>
<ul>
<li>Skip an <code>if</code> or <code>else</code> path with <code>/* istanbul ignore if */</code> or <code>/* istanbul ignore else */</code> respectively.</li>
<li>For all other cases, skip the next 'thing' in the source with: <code>/* istanbul ignore next */</code></li>
</ul>
<p>See ignoring-code-for-coverage.md for the spec.</p>
<h3>API</h3>
<p>All the features of istanbul can be accessed as a library.</p>
<h4>Instrument code</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var istanbul = require(&#39;istanbul&#39;);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;var instrumenter = new istanbul.Instrumenter();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;var generatedCode = instrumenter.instrumentSync(&#39;function meaningOfLife() { return 42; }&#39;,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &#39;filename.js&#39;);</div>
</div><!-- fragment --><h4>Generate reports given a bunch of coverage JSON objects</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var istanbul = require(&#39;istanbul&#39;),</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    collector = new istanbul.Collector(),</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    reporter = new istanbul.Reporter(),</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    sync = false;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;collector.add(obj1);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;collector.add(obj2); //etc.</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;reporter.add(&#39;text&#39;);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;reporter.addAll([ &#39;lcov&#39;, &#39;clover&#39; ]);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;reporter.write(collector, sync, function () {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    console.log(&#39;All reports generated&#39;);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;});</div>
</div><!-- fragment --><p>For the gory details consult the <a href="http://gotwarlost.github.com/istanbul/public/apidocs/index.html">public API</a></p>
<h3>Multiple Process Usage</h3>
<p>Istanbul can be used in a multiple process environment by running each process with Istanbul, writing a unique coverage file for each process, and combining the results when generating reports. The method used to perform this will depend on the process forking API used. For example when using the <a href="http://nodejs.org/api/cluster.html">cluster module</a> you must setup the master to start child processes with Istanbul coverage, disable reporting, and output coverage files that include the PID in the filename. Before each run you may need to clear out the coverage data directory.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;if(cluster.isMaster) {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    // setup cluster if running with istanbul coverage</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    if(process.env.running_under_istanbul) {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        // use coverage for forked process</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        // disabled reporting and output for child process</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        // enable pid in child process coverage filename</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        cluster.setupMaster({</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            exec: &#39;./node_modules/.bin/istanbul&#39;,</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;            args: [</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                &#39;cover&#39;, &#39;--report&#39;, &#39;none&#39;, &#39;--print&#39;, &#39;none&#39;, &#39;--include-pid&#39;,</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                process.argv[1], &#39;--&#39;].concat(process.argv.slice(2))</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        });</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    // ...</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    // ... cluster.fork();</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    // ...</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;} else {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    // ... worker code</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div>
</div><!-- fragment --><h3>Coverage.json</h3>
<p>For details on the format of the coverage.json object, ./coverage.json.md "see here".</p>
<h3>License</h3>
<p>istanbul is licensed under the <a href="http://github.com/gotwarlost/istanbul/raw/master/LICENSE">BSD License</a>.</p>
<h3>Third-party libraries</h3>
<p>The following third-party libraries are used by this module:</p>
<ul>
<li>abbrev: <a href="https://github.com/isaacs/abbrev-js">https://github.com/isaacs/abbrev-js</a> - to handle command abbreviations</li>
<li>async: <a href="https://github.com/caolan/async">https://github.com/caolan/async</a> - for parallel instrumentation of files</li>
<li>escodegen: <a href="https://github.com/Constellation/escodegen">https://github.com/Constellation/escodegen</a> - for JS code generation</li>
<li>esprima: <a href="https://github.com/ariya/esprima">https://github.com/ariya/esprima</a> - for JS parsing</li>
<li>fileset: <a href="https://github.com/mklabs/node-fileset">https://github.com/mklabs/node-fileset</a> - for loading and matching path expressions</li>
<li>handlebars: <a href="https://github.com/wycats/handlebars.js/">https://github.com/wycats/handlebars.js/</a> - for report template expansion</li>
<li>js-yaml: <a href="https://github.com/nodeca/js-yaml">https://github.com/nodeca/js-yaml</a> - for YAML config file load</li>
<li>mkdirp: <a href="https://github.com/substack/node-mkdirp">https://github.com/substack/node-mkdirp</a> - to create output directories</li>
<li>nodeunit: <a href="https://github.com/caolan/nodeunit">https://github.com/caolan/nodeunit</a> - dev dependency for unit tests</li>
<li>nopt: <a href="https://github.com/isaacs/nopt">https://github.com/isaacs/nopt</a> - for option parsing</li>
<li>once: <a href="https://github.com/isaacs/once">https://github.com/isaacs/once</a> - to ensure callbacks are called once</li>
<li>resolve: <a href="https://github.com/substack/node-resolve">https://github.com/substack/node-resolve</a> - for resolving a post-require hook module name into its main file.</li>
<li>rimraf - <a href="https://github.com/isaacs/rimraf">https://github.com/isaacs/rimraf</a> - dev dependency for unit tests</li>
<li>which: <a href="https://github.com/isaacs/node-which">https://github.com/isaacs/node-which</a> - to resolve a node command to a file for the <code>cover</code> command</li>
<li>wordwrap: <a href="https://github.com/substack/node-wordwrap">https://github.com/substack/node-wordwrap</a> - for prettier help</li>
<li>prettify: <a href="http://code.google.com/p/google-code-prettify/">http://code.google.com/p/google-code-prettify/</a> - for syntax colored HTML reports. Files checked in under <code>lib/vendor/</code></li>
</ul>
<h3>Inspired by</h3>
<ul>
<li>YUI test coverage - <a href="https://github.com/yui/yuitest">https://github.com/yui/yuitest</a> - the grand-daddy of JS coverage tools. Istanbul has been specifically designed to offer an alternative to this library with an easy migration path.</li>
<li>cover: <a href="https://github.com/itay/node-cover">https://github.com/itay/node-cover</a> - the inspiration for the <code>cover</code> command, modeled after the <code>run</code> command in that tool. The coverage methodology used by istanbul is quite different, however</li>
</ul>
<h3>Shout out to</h3>
<ul>
<li><a href="https://github.com/mfncooper">mfncooper</a> - for great brainstorming discussions</li>
<li><a href="https://github.com/reid">reid</a>, <a href="https://github.com/davglass">davglass</a>, the YUI dudes, for interesting conversations, encouragement, support and gentle pressure to get it done :)</li>
</ul>
<h3>Why the funky name?</h3>
<p>Since all the good ones are taken. Comes from the loose association of ideas across coverage, carpet-area coverage, the country that makes good carpets and so on... </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
