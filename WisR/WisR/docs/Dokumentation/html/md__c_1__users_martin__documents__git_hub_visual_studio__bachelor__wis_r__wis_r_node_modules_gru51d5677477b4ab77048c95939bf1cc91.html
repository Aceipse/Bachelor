<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WisR web applikation: Request — Simplified HTTP client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WisR web applikation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Request — Simplified HTTP client </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://nodei.co/npm/request/">![NPM](https://nodei.co/npm/request.png?downloads=true&amp;downloadRank=true&amp;stars=true)</a></p>
<h2>Super simple to use</h2>
<p>Request is designed to be the simplest way possible to make http calls. It supports HTTPS and follows redirects by default.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var request = require(&#39;request&#39;);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;request(&#39;http://www.google.com&#39;, function (error, response, body) {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  if (!error &amp;&amp; response.statusCode == 200) {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    console.log(body) // Print the google web page.</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  }</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;})</div>
</div><!-- fragment --><h2>Streaming</h2>
<p>You can stream any response to a file stream.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request(&#39;http://google.com/doodle.png&#39;).pipe(fs.createWriteStream(&#39;doodle.png&#39;))</div>
</div><!-- fragment --><p>You can also stream a file to a PUT or POST request. This method will also check the file extension against a mapping of file extensions to content-types (in this case <code>application/json</code>) and use the proper <code>content-type</code> in the PUT request (if the headers don’t already provide one).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;fs.createReadStream(&#39;file.json&#39;).pipe(request.put(&#39;http://mysite.com/obj.json&#39;))</div>
</div><!-- fragment --><p>Request can also <code>pipe</code> to itself. When doing so, <code>content-type</code> and <code>content-length</code> are preserved in the PUT headers.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.get(&#39;http://google.com/img.png&#39;).pipe(request.put(&#39;http://mysite.com/img.png&#39;))</div>
</div><!-- fragment --><p>Now let’s get fancy.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;http.createServer(function (req, resp) {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  if (req.url === &#39;/doodle.png&#39;) {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    if (req.method === &#39;PUT&#39;) {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      req.pipe(request.put(&#39;http://mysite.com/doodle.png&#39;))</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    } else if (req.method === &#39;GET&#39; || req.method === &#39;HEAD&#39;) {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      request.get(&#39;http://mysite.com/doodle.png&#39;).pipe(resp)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    }</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  }</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;})</div>
</div><!-- fragment --><p>You can also <code>pipe()</code> from <code>http.ServerRequest</code> instances, as well as to <code>http.ServerResponse</code> instances. The HTTP method, headers, and entity-body data will be sent. Which means that, if you don't really care about security, you can do:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;http.createServer(function (req, resp) {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  if (req.url === &#39;/doodle.png&#39;) {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    var x = request(&#39;http://mysite.com/doodle.png&#39;)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    req.pipe(x)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    x.pipe(resp)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  }</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;})</div>
</div><!-- fragment --><p>And since <code>pipe()</code> returns the destination stream in ≥ Node 0.5.x you can do one line proxying. :)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;req.pipe(request(&#39;http://mysite.com/doodle.png&#39;)).pipe(resp)</div>
</div><!-- fragment --><p>Also, none of this new functionality conflicts with requests previous features, it just expands them.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var r = request.defaults({&#39;proxy&#39;:&#39;http://localproxy.com&#39;})</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;http.createServer(function (req, resp) {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  if (req.url === &#39;/doodle.png&#39;) {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    r.get(&#39;http://google.com/doodle.png&#39;).pipe(resp)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  }</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;})</div>
</div><!-- fragment --><p>You can still use intermediate proxies, the requests will still follow HTTP forwards, etc.</p>
<h2>Proxies</h2>
<p>If you specify a <code>proxy</code> option, then the request (and any subsequent redirects) will be sent via a connection to the proxy server.</p>
<p>If your endpoint is an <code>https</code> url, and you are using a proxy, then request will send a <code>CONNECT</code> request to the proxy server <em>first</em>, and then use the supplied connection to connect to the endpoint.</p>
<p>That is, first it will make a request like:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;HTTP/1.1 CONNECT endpoint-server.com:80</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Host: proxy-server.com</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;User-Agent: whatever user agent you specify</div>
</div><!-- fragment --><p>and then the proxy server make a TCP connection to <code>endpoint-server</code> on port <code>80</code>, and return a response that looks like:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;HTTP/1.1 200 OK</div>
</div><!-- fragment --><p>At this point, the connection is left open, and the client is communicating directly with the <code>endpoint-server.com</code> machine.</p>
<p>See (the wikipedia page on HTTP Tunneling)[<a href="http://en.wikipedia.org/wiki/HTTP_tunnel">http://en.wikipedia.org/wiki/HTTP_tunnel</a>] for more information.</p>
<p>By default, when proxying <code>http</code> traffic, request will simply make a standard proxied <code>http</code> request. This is done by making the <code>url</code> section of the initial line of the request a fully qualified url to the endpoint.</p>
<p>For example, it will make a single request that looks like:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;HTTP/1.1 GET http://endpoint-server.com/some-url</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Host: proxy-server.com</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Other-Headers: all go here</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;request body or whatever</div>
</div><!-- fragment --><p>Because a pure "http over http" tunnel offers no additional security or other features, it is generally simpler to go with a straightforward HTTP proxy in this case. However, if you would like to force a tunneling proxy, you may set the <code>tunnel</code> option to <code>true</code>.</p>
<p>If you are using a tunneling proxy, you may set the <code>proxyHeaderWhiteList</code> to share certain headers with the proxy.</p>
<p>By default, this set is:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;accept</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;accept-charset</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;accept-encoding</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;accept-language</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;accept-ranges</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;cache-control</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;content-encoding</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;content-language</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;content-length</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;content-location</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;content-md5</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;content-range</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;content-type</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;connection</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;date</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;expect</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;max-forwards</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;pragma</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;proxy-authorization</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;referer</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;te</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;transfer-encoding</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;user-agent</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;via</div>
</div><!-- fragment --><p>Note that, when using a tunneling proxy, the <code>proxy-authorization</code> header is <em>never</em> sent to the endpoint server, but only to the proxy server. All other headers are sent as-is over the established connection.</p>
<h2>UNIX Socket</h2>
<p><code>request</code> supports the <code>unix://</code> protocol for all requests. The path is assumed to be absolute to the root of the host file system.</p>
<p>HTTP paths are extracted from the supplied URL by testing each level of the full URL against net.connect for a socket response.</p>
<p>Thus the following request will GET <code>/httppath</code> from the HTTP server listening on <code>/tmp/unix.socket</code></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.get(&#39;unix://tmp/unix.socket/httppath&#39;)</div>
</div><!-- fragment --><h2>Forms</h2>
<p><code>request</code> supports <code>application/x-www-form-urlencoded</code> and <code>multipart/form-data</code> form uploads. For <code>multipart/related</code> refer to the <code>multipart</code> API.</p>
<p>URL-encoded forms are simple.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.post(&#39;http://service.com/upload&#39;, {form:{key:&#39;value&#39;}})</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// or</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;request.post(&#39;http://service.com/upload&#39;).form({key:&#39;value&#39;})</div>
</div><!-- fragment --><p>For <code>multipart/form-data</code> we use the <a href="https://github.com/felixge/node-form-data">form-data</a> library by <a href="https://github.com/felixge"></a>. You don’t need to worry about piping the form object or setting the headers, <code>request</code> will handle that for you.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var r = request.post(&#39;http://service.com/upload&#39;, function optionalCallback (err, httpResponse, body) {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  if (err) {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    return console.error(&#39;upload failed:&#39;, err);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  }</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  console.log(&#39;Upload successful!  Server responded with:&#39;, body);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;})</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;var form = r.form()</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;form.append(&#39;my_field&#39;, &#39;my_value&#39;)</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;form.append(&#39;my_buffer&#39;, new Buffer([1, 2, 3]))</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;form.append(&#39;my_file&#39;, fs.createReadStream(path.join(__dirname, &#39;doodle.png&#39;)))</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;form.append(&#39;remote_file&#39;, request(&#39;http://google.com/doodle.png&#39;))</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;// Just like always, `r` is a writable stream, and can be used as such (you have until nextTick to pipe it, etc.)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;// Alternatively, you can provide a callback (that&#39;s what this example does — see `optionalCallback` above).</div>
</div><!-- fragment --><h2>HTTP Authentication</h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.get(&#39;http://some.server.com/&#39;).auth(&#39;username&#39;, &#39;password&#39;, false);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// or</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;request.get(&#39;http://some.server.com/&#39;, {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  &#39;auth&#39;: {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &#39;user&#39;: &#39;username&#39;,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &#39;pass&#39;: &#39;password&#39;,</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    &#39;sendImmediately&#39;: false</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  }</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;});</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;// or</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;request.get(&#39;http://some.server.com/&#39;).auth(null, null, true, &#39;bearerToken&#39;);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;// or</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;request.get(&#39;http://some.server.com/&#39;, {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  &#39;auth&#39;: {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    &#39;bearer&#39;: &#39;bearerToken&#39;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;});</div>
</div><!-- fragment --><p>If passed as an option, <code>auth</code> should be a hash containing values <code>user</code> || <code>username</code>, <code>pass</code> || <code>password</code>, and <code>sendImmediately</code> (optional). The method form takes parameters <code>auth(username, password, sendImmediately)</code>.</p>
<p><code>sendImmediately</code> defaults to <code>true</code>, which causes a basic authentication header to be sent. If <code>sendImmediately</code> is <code>false</code>, then <code>request</code> will retry with a proper authentication header after receiving a <code>401</code> response from the server (which must contain a <code>WWW-Authenticate</code> header indicating the required authentication method).</p>
<p>Note that you can also use for basic authentication a trick using the URL itself, as specified in <a href="http://www.ietf.org/rfc/rfc1738.txt">RFC 1738</a>. Simply pass the <code>user:password</code> before the host with an <code>@</code> sign.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var username = &#39;username&#39;,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    password = &#39;password&#39;,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    url = &#39;http://&#39; + username + &#39;:&#39; + password + &#39;@some.server.com&#39;;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;request({url: url}, function (error, response, body) {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;   // Do more stuff with &#39;body&#39; here</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;});</div>
</div><!-- fragment --><p>Digest authentication is supported, but it only works with <code>sendImmediately</code> set to <code>false</code>; otherwise <code>request</code> will send basic authentication on the initial request, which will probably cause the request to fail.</p>
<p>Bearer authentication is supported, and is activated when the <code>bearer</code> value is available. The value may be either a <code>String</code> or a <code>Function</code> returning a <code>String</code>. Using a function to supply the bearer token is particularly useful if used in conjuction with <code>defaults</code> to allow a single function to supply the last known token at the time or sending a request or to compute one on the fly.</p>
<h2>OAuth Signing</h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Twitter OAuth</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;var qs = require(&#39;querystring&#39;)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  , oauth =</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    { callback: &#39;http://mysite.com/callback/&#39;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    , consumer_key: CONSUMER_KEY</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    , consumer_secret: CONSUMER_SECRET</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    }</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  , url = &#39;https://api.twitter.com/oauth/request_token&#39;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  ;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;request.post({url:url, oauth:oauth}, function (e, r, body) {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  // Ideally, you would take the body in the response</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  // and construct a URL that a user clicks on (like a sign in button).</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  // The verifier is only available in the response after a user has</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  // verified with twitter that they are authorizing your app.</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  var access_token = qs.parse(body)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    , oauth =</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      { consumer_key: CONSUMER_KEY</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      , consumer_secret: CONSUMER_SECRET</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      , token: access_token.oauth_token</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      , verifier: access_token.oauth_verifier</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    , url = &#39;https://api.twitter.com/oauth/access_token&#39;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    ;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  request.post({url:url, oauth:oauth}, function (e, r, body) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    var perm_token = qs.parse(body)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      , oauth =</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        { consumer_key: CONSUMER_KEY</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        , consumer_secret: CONSUMER_SECRET</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        , token: perm_token.oauth_token</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        , token_secret: perm_token.oauth_token_secret</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      , url = &#39;https://api.twitter.com/1.1/users/show.json?&#39;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      , params =</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        { screen_name: perm_token.screen_name</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        , user_id: perm_token.user_id</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      ;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    url += qs.stringify(params)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    request.get({url:url, oauth:oauth, json:true}, function (e, r, user) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      console.log(user)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    })</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  })</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;})</div>
</div><!-- fragment --><h2>Custom HTTP Headers</h2>
<p>HTTP Headers, such as <code>User-Agent</code>, can be set in the <code>options</code> object. In the example below, we call the github API to find out the number of stars and forks for the request repository. This requires a custom <code>User-Agent</code> header as well as https.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var request = require(&#39;request&#39;);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;var options = {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    url: &#39;https://api.github.com/repos/mikeal/request&#39;,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    headers: {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &#39;User-Agent&#39;: &#39;request&#39;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    }</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;};</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;function callback(error, response, body) {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    if (!error &amp;&amp; response.statusCode == 200) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        var info = JSON.parse(body);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        console.log(info.stargazers_count + &quot; Stars&quot;);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        console.log(info.forks_count + &quot; Forks&quot;);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;request(options, callback);</div>
</div><!-- fragment --><h2>request(options, callback)</h2>
<p>The first argument can be either a <code>url</code> or an <code>options</code> object. The only required option is <code>uri</code>; all others are optional.</p>
<ul>
<li><code>uri</code> || <code>url</code> - fully qualified uri or a parsed url object from <code>url.parse()</code></li>
<li><code>qs</code> - object containing querystring values to be appended to the <code>uri</code></li>
<li><code>method</code> - http method (default: <code>"GET"</code>)</li>
<li><code>headers</code> - http headers (default: <code>{}</code>)</li>
<li><code>body</code> - entity body for PATCH, POST and PUT requests. Must be a <code>Buffer</code> or <code>String</code>.</li>
<li><code>form</code> - when passed an object or a querystring, this sets <code>body</code> to a querystring representation of value, and adds <code>Content-type: application/x-www-form-urlencoded; charset=utf-8</code> header. When passed no options, a <code>FormData</code> instance is returned (and is piped to request).</li>
<li><code>auth</code> - A hash containing values <code>user</code> || <code>username</code>, <code>pass</code> || <code>password</code>, and <code>sendImmediately</code> (optional). See documentation above.</li>
<li><code>json</code> - sets <code>body</code> but to JSON representation of value and adds <code>Content-type: application/json</code> header. Additionally, parses the response body as JSON.</li>
<li><code>multipart</code> - (experimental) array of objects which contains their own headers and <code>body</code> attribute. Sends <code>multipart/related</code> request. See example below.</li>
<li><code>followRedirect</code> - follow HTTP 3xx responses as redirects (default: <code>true</code>). This property can also be implemented as function which gets <code>response</code> object as a single argument and should return <code>true</code> if redirects should continue or <code>false</code> otherwise.</li>
<li><code>followAllRedirects</code> - follow non-GET HTTP 3xx responses as redirects (default: <code>false</code>)</li>
<li><code>maxRedirects</code> - the maximum number of redirects to follow (default: <code>10</code>)</li>
<li><code>encoding</code> - Encoding to be used on <code>setEncoding</code> of response data. If <code>null</code>, the <code>body</code> is returned as a <code>Buffer</code>.</li>
<li><code>pool</code> - A hash object containing the agents for these requests. If omitted, the request will use the global pool (which is set to node's default <code>maxSockets</code>)</li>
<li><code>pool.maxSockets</code> - Integer containing the maximum amount of sockets in the pool.</li>
<li><code>timeout</code> - Integer containing the number of milliseconds to wait for a request to respond before aborting the request</li>
<li><code>proxy</code> - An HTTP proxy to be used. Supports proxy Auth with Basic Auth, identical to support for the <code>url</code> parameter (by embedding the auth info in the <code>uri</code>)</li>
<li><code>oauth</code> - Options for OAuth HMAC-SHA1 signing. See documentation above.</li>
<li><code>hawk</code> - Options for <a href="https://github.com/hueniverse/hawk">Hawk signing</a>. The <code>credentials</code> key must contain the necessary signing info, <a href="https://github.com/hueniverse/hawk#usage-example">see hawk docs for details</a>.</li>
<li><code>strictSSL</code> - If <code>true</code>, requires SSL certificates be valid. <b>Note:</b> to use your own certificate authority, you need to specify an agent that was created with that CA as an option.</li>
<li><code>jar</code> - If <code>true</code> and <code>tough-cookie</code> is installed, remember cookies for future use (or define your custom cookie jar; see examples section)</li>
<li><code>aws</code> - <code>object</code> containing AWS signing information. Should have the properties <code>key</code>, <code>secret</code>. Also requires the property <code>bucket</code>, unless you’re specifying your <code>bucket</code> as part of the path, or the request doesn’t use a bucket (i.e. GET Services)</li>
<li><code>httpSignature</code> - Options for the https://github.com/joyent/node-http-signature/blob/master/http_signing.md "HTTP Signature Scheme" using <a href="https://github.com/joyent/node-http-signature">Joyent's library</a>. The <code>keyId</code> and <code>key</code> properties must be specified. See the docs for other options.</li>
<li><code>localAddress</code> - Local interface to bind for network connections.</li>
<li><code>gzip</code> - If <code>true</code>, add an <code>Accept-Encoding</code> header to request compressed content encodings from the server (if not already present) and decode supported content encodings in the response.</li>
<li><code>tunnel</code> - If <code>true</code>, then <em>always</em> use a tunneling proxy. If <code>false</code> (default), then tunneling will only be used if the destination is <code>https</code>, or if a previous request in the redirect chain used a tunneling proxy.</li>
<li><code>proxyHeaderWhiteList</code> - A whitelist of headers to send to a tunneling proxy.</li>
</ul>
<p>The callback argument gets 3 arguments:</p>
<ol type="1">
<li>An <code>error</code> when applicable (usually from <a href="http://nodejs.org/api/http.html#http_class_http_clientrequest">`http.ClientRequest`</a> object)</li>
<li>An <a href="http://nodejs.org/api/http.html#http_http_incomingmessage">`http.IncomingMessage`</a> object</li>
<li>The third is the <code>response</code> body (<code>String</code> or <code>Buffer</code>, or JSON object if the <code>json</code> option is supplied)</li>
</ol>
<h2>Convenience methods</h2>
<p>There are also shorthand methods for different HTTP METHODs and some other conveniences.</p>
<h3>request.defaults(options)</h3>
<p>This method returns a wrapper around the normal request API that defaults to whatever options you pass in to it.</p>
<p><b>Note:</b> You can call <code>.defaults()</code> on the wrapper that is returned from <code>request.defaults</code> to add/override defaults that were previously defaulted.</p>
<p>For example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;//requests using baseRequest() will set the &#39;x-token&#39; header</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;var baseRequest = request.defaults({</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  headers: {x-token: &#39;my-token&#39;}</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;})</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;//requests using specialRequest() will include the &#39;x-token&#39; header set in</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;//baseRequest and will also include the &#39;special&#39; header</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;var specialRequest = baseRequest.defaults({</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  headers: {special: &#39;special value&#39;}</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;})</div>
</div><!-- fragment --><h3>request.put</h3>
<p>Same as <code>request()</code>, but defaults to <code>method: "PUT"</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.put(url)</div>
</div><!-- fragment --><h3>request.patch</h3>
<p>Same as <code>request()</code>, but defaults to <code>method: "PATCH"</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.patch(url)</div>
</div><!-- fragment --><h3>request.post</h3>
<p>Same as <code>request()</code>, but defaults to <code>method: "POST"</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.post(url)</div>
</div><!-- fragment --><h3>request.head</h3>
<p>Same as request() but defaults to <code>method: "HEAD"</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.head(url)</div>
</div><!-- fragment --><h3>request.del</h3>
<p>Same as <code>request()</code>, but defaults to <code>method: "DELETE"</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.del(url)</div>
</div><!-- fragment --><h3>request.get</h3>
<p>Same as <code>request()</code> (for uniformity).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.get(url)</div>
</div><!-- fragment --> <h3>request.cookie</h3>
<p>Function that creates a new cookie.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.cookie(&#39;cookie_string_here&#39;)</div>
</div><!-- fragment --> <h3>request.jar</h3>
<p>Function that creates a new cookie jar.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;request.jar()</div>
</div><!-- fragment --><h2>Examples:</h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var request = require(&#39;request&#39;)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  , rand = Math.floor(Math.random()*100000000).toString()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  ;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;request(</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  { method: &#39;PUT&#39;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  , uri: &#39;http://mikeal.iriscouch.com/testjs/&#39; + rand</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  , multipart:</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    [ { &#39;content-type&#39;: &#39;application/json&#39;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;      ,  body: JSON.stringify({foo: &#39;bar&#39;, _attachments: {&#39;message.txt&#39;: {follows: true, length: 18, &#39;content_type&#39;: &#39;text/plain&#39; }}})</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;      }</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    , { body: &#39;I am an attachment&#39; }</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    ]</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;, function (error, response, body) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    if(response.statusCode == 201){</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      console.log(&#39;document saved as: http://mikeal.iriscouch.com/testjs/&#39;+ rand)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    } else {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      console.log(&#39;error: &#39;+ response.statusCode)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      console.log(body)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;)</div>
</div><!-- fragment --><p>Cookies are disabled by default (else, they would be used in subsequent requests). To enable cookies, set <code>jar</code> to <code>true</code> (either in <code>defaults</code> or <code>options</code>) and install <code>tough-cookie</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var request = request.defaults({jar: true})</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;request(&#39;http://www.google.com&#39;, function () {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  request(&#39;http://images.google.com&#39;)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;})</div>
</div><!-- fragment --><p>To use a custom cookie jar (instead of <code>request</code>’s global cookie jar), set <code>jar</code> to an instance of <code>request.jar()</code> (either in <code>defaults</code> or <code>options</code>)</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var j = request.jar()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;var request = request.defaults({jar:j})</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;request(&#39;http://www.google.com&#39;, function () {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  request(&#39;http://images.google.com&#39;)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;})</div>
</div><!-- fragment --><p>OR</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// `npm install --save tough-cookie` before this works</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;var j = request.jar()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;var cookie = request.cookie(&#39;your_cookie_here&#39;)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;j.setCookie(cookie, uri);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;request({url: &#39;http://www.google.com&#39;, jar: j}, function () {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  request(&#39;http://images.google.com&#39;)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;})</div>
</div><!-- fragment --><p>To inspect your cookie jar after a request</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;var j = request.jar() </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;request({url: &#39;http://www.google.com&#39;, jar: j}, function () {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  var cookie_string = j.getCookieString(uri); // &quot;key1=value1; key2=value2; ...&quot;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  var cookies = j.getCookies(uri); </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  // [{key: &#39;key1&#39;, value: &#39;value1&#39;, domain: &quot;www.google.com&quot;, ...}, ...]</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;})</div>
</div><!-- fragment --><h2>Debugging</h2>
<p>There are at least three ways to debug the operation of <code>request</code>:</p>
<ol type="1">
<li>Launch the node process like <code>NODE_DEBUG=request node script.js</code> (<code>lib,request,otherlib</code> works too).</li>
<li>Set `require('request').debug = true` at any time (this does the same thing as #1).</li>
<li>Use the <a href="https://github.com/nylen/request-debug">request-debug module</a> to view request and response headers and bodies. </li>
</ol>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
